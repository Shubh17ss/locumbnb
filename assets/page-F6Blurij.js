import{u as W,r as c,j as e,s as o}from"./index-Hl5FDKDL.js";import{a as M,v as V,f as w}from"./validation-C4eTZtKi.js";function U(){const y=W(),[n,j]=c.useState("email"),[h,N]=c.useState("password"),[i,E]=c.useState(""),[g,L]=c.useState(""),[b,O]=c.useState(!1),[I,v]=c.useState(!1),[p,F]=c.useState(["","","","","",""]),[x,r]=c.useState(!1),[f,a]=c.useState(""),P="credentials"in navigator&&"PublicKeyCredential"in window,k="credentials"in navigator,T=async()=>{if(r(!0),a(""),n==="phone"){const t=M(i);if(!t.valid){a(t.error||"Invalid phone number"),r(!1);return}}else{const t=V(i);if(!t.valid){a(t.error||"Invalid email"),r(!1);return}}try{if(n==="phone"){const t=w(i),{error:s}=await o.auth.signInWithOtp({phone:t});if(s)throw s}else{const{error:t}=await o.auth.signInWithOtp({email:i});if(t)throw t}v(!0)}catch(t){a(t.message||"Failed to send verification code")}finally{r(!1)}},R=(t,s)=>{if(s.length>1)return;const l=[...p];l[t]=s,F(l),s&&t<5&&document.getElementById(`otp-${t+1}`)?.focus()},S=async t=>{t.preventDefault(),r(!0),a("");try{let s;if(h==="otp"){const m=p.join("");if(n==="phone"){const d=w(i),{data:u,error:C}=await o.auth.verifyOtp({phone:d,token:m,type:"sms"});if(C)throw C;s=u}else{const{data:d,error:u}=await o.auth.verifyOtp({email:i,token:m,type:"email"});if(u)throw u;s=d}}else if(n==="phone"){const m=w(i),{data:d,error:u}=await o.auth.signInWithPassword({phone:m,password:g});if(u)throw u;s=d}else{const{data:m,error:d}=await o.auth.signInWithPassword({email:i,password:g});if(d)throw d;s=m}if(s.user?.user_metadata?.role?.toLowerCase()!=="facility"){a("This login is for facilities only. Please use the correct login page for your account type."),await o.auth.signOut(),r(!1);return}y("/facility-dashboard",{replace:!0})}catch(s){a(s.message||"Login failed. Please check your credentials.")}finally{r(!1)}},$=async()=>{r(!0),a("");try{await new Promise(l=>setTimeout(l,1e3));const{data:t}=await o.auth.getUser();if(t.user?.user_metadata?.role?.toLowerCase()!=="facility"){a("This login is for facilities only."),await o.auth.signOut(),r(!1);return}y("/facility-dashboard",{replace:!0})}catch{a("Passkey authentication failed"),r(!1)}},B=async()=>{r(!0),a("");try{await new Promise(l=>setTimeout(l,1e3));const{data:t}=await o.auth.getUser();if(t.user?.user_metadata?.role?.toLowerCase()!=="facility"){a("This login is for facilities only."),await o.auth.signOut(),r(!1);return}y("/facility-dashboard",{replace:!0})}catch{a("Biometric authentication failed"),r(!1)}};return I&&h==="otp"?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4 py-12",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-teal-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-mail-send-line text-teal-600 text-2xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Enter verification code"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["We sent a 6-digit code to ",i]})]}),e.jsxs("form",{onSubmit:S,children:[e.jsx("div",{className:"flex justify-center space-x-3 mb-6",children:p.map((t,s)=>e.jsx("input",{id:`otp-${s}`,type:"text",maxLength:1,value:t,onChange:l=>R(s,l.target.value),className:"w-12 h-12 text-center text-xl font-semibold border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"},s))}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-600",children:[e.jsx("i",{className:"ri-error-warning-line mr-1"}),f]})}),e.jsx("button",{type:"submit",disabled:x||p.some(t=>!t),className:"w-full px-6 py-3 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed whitespace-nowrap",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Verifying..."]}):"Verify & Log In"}),e.jsx("button",{type:"button",onClick:()=>v(!1),className:"w-full mt-3 text-sm text-gray-600 hover:text-gray-900 whitespace-nowrap",children:"Use a different method"})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Facility Login"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Access your facility dashboard"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>j("email"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors whitespace-nowrap ${n==="email"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx("i",{className:"ri-mail-line mr-2"}),"Email"]}),e.jsxs("button",{type:"button",onClick:()=>j("phone"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors whitespace-nowrap ${n==="phone"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx("i",{className:"ri-phone-line mr-2"}),"Phone"]})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:n==="email"?"Email address":"Phone number"}),e.jsx("input",{type:n==="email"?"email":"tel",value:i,onChange:t=>{E(t.target.value),a("")},placeholder:n==="email"?"you@facility.com":"(555) 123-4567",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{type:"button",onClick:()=>N("password"),className:`flex-1 px-3 py-2 text-xs font-medium rounded-md transition-colors whitespace-nowrap ${h==="password"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>N("otp"),className:`flex-1 px-3 py-2 text-xs font-medium rounded-md transition-colors whitespace-nowrap ${h==="otp"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"One-time code"})]}),h==="password"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b?"text":"password",value:g,onChange:t=>{L(t.target.value),a("")},placeholder:"Enter your password",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500",required:!0}),e.jsx("button",{type:"button",onClick:()=>O(!b),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx("i",{className:b?"ri-eye-off-line":"ri-eye-line"})})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm",children:e.jsx("a",{href:"/forgot-password",className:"text-teal-600 hover:text-teal-700 whitespace-nowrap",children:"Forgot password?"})})]}):e.jsx("button",{type:"button",onClick:T,disabled:x||!i,className:"w-full px-6 py-3 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed whitespace-nowrap",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Sending code..."]}):"Send verification code"}),f&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-600",children:[e.jsx("i",{className:"ri-error-warning-line mr-1"}),f]})}),h==="password"&&e.jsx("button",{type:"submit",disabled:x||!i||!g,className:"w-full px-6 py-3 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed whitespace-nowrap",children:x?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Logging in..."]}):"Log In"})]}),(P||k)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsxs("div",{className:"space-y-2",children:[P&&e.jsxs("button",{type:"button",onClick:$,className:"w-full px-4 py-3 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-key-2-line mr-2"}),"Sign in with Passkey"]}),k&&e.jsxs("button",{type:"button",onClick:B,className:"w-full px-4 py-3 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-fingerprint-line mr-2"}),"Sign in with Biometrics"]})]})]}),e.jsx("div",{className:"mt-6 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("i",{className:"ri-shield-check-line mr-1"}),"Enable 2FA in your account security settings for additional protection."]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx("a",{href:"/signup?role=facility",className:"text-teal-600 hover:text-teal-700 font-medium whitespace-nowrap",children:"Create facility account"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Technology marketplace only. Not an employer or staffing agency."})})]})})}export{U as default};
//# sourceMappingURL=page-F6Blurij.js.map
