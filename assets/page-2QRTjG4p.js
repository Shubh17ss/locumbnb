import{j as e,r as o,s as L,u as X}from"./index-Cg48h7fn.js";import{N as Z}from"./NotificationPanel-zIli_TJs.js";import{m as ee,a as se,b as te,c as ae,g as le,d as ie,e as re,f as ne,P as ce,S as de}from"./applications-DWFwd-s-.js";import{g as oe,m as me,a as xe,b as ue,c as he}from"./vendors-BEq1FQdI.js";import{u as W}from"./useProfileCompletion-CUiJFVy2.js";const pe=({isComplete:s,completionPercentage:a,onCompleteProfile:d})=>e.jsx("div",{className:`rounded-lg p-4 mb-6 border-2 ${s?"bg-green-50 border-green-500":"bg-red-50 border-red-500"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:s?e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-check-line text-white text-sm"})}):e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-error-warning-line text-white text-sm"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:`text-base font-semibold ${s?"text-green-800":"text-red-800"}`,children:s?"Profile Complete":"Profile Incomplete"}),e.jsxs("span",{className:`text-sm font-medium ${s?"text-green-700":"text-red-700"}`,children:[a,"%"]})]}),e.jsx("p",{className:`text-sm mb-3 ${s?"text-green-700":"text-red-700"}`,children:s?"Your profile is complete. You can now apply to assignments.":"Complete all required sections to apply to assignments. You can browse assignments while your profile is incomplete."}),!s&&e.jsx("div",{className:"w-full bg-red-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]})]}),!s&&e.jsx("button",{onClick:d,className:"flex-shrink-0 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"Complete Profile"})]})});function ge(){const[s,a]=o.useState([]),[d,g]=o.useState(!0),[N,D]=o.useState(null),[h,w]=o.useState(!1);o.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:y}=await L.auth.getUser();if(!y.user){g(!1);return}const{data:c}=await L.from("physician_profiles").select("id").eq("user_id",y.user.id).maybeSingle();if(!c){g(!1);return}a([]),g(!1)}catch(y){console.error("Error fetching applications:",y),g(!1)}},T=s.filter(y=>y.status==="pending"),l=s.filter(y=>y.status==="expired"),i=y=>new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),n=y=>new Date(y).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),r=y=>{const c=new Date,k=new Date(y).getTime()-c.getTime();if(k<=0)return"Expired";const F=Math.floor(k/(1e3*60*60)),$=Math.floor(k%(1e3*60*60)/(1e3*60));if(F<24)return`${F}h ${$}m remaining`;const I=Math.floor(F/24);return`${I} day${I>1?"s":""} remaining`},b=y=>new Date(y)<new Date,m=y=>{confirm("Are you sure you want to withdraw this application? Your calendar dates will be unblocked.")&&a(s.map(c=>c.id===y?{...c,status:"withdrawn",calendarBlocked:!1}:c))},v=y=>{D(y),w(!0)};return d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading applications..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Pending Review (",T.length,")"]}),T.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx("i",{className:"ri-file-list-3-line text-4xl text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No pending applications"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Applications you submit will appear here"})]}):e.jsx("div",{className:"space-y-4",children:T.map(y=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:y.profileSnapshot.professionalInfo.specialty}),e.jsx("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded-full whitespace-nowrap",children:"Under Review"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsxs("span",{children:[i(y.blockedDates.startDate)," - ",i(y.blockedDates.endDate)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-time-line"}),e.jsxs("span",{children:["Applied ",n(y.appliedAt)]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${b(y.reviewDeadline)?"text-red-600":"text-teal-600"}`,children:r(y.reviewDeadline)}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Deadline: ",n(y.reviewDeadline)]})]})]}),y.calendarBlocked&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-900",children:[e.jsx("i",{className:"ri-lock-line"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Calendar Blocked:"})," These dates are temporarily blocked while the facility reviews your application."]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>v(y),className:"text-sm text-teal-600 hover:text-teal-700 font-medium whitespace-nowrap",children:"View Details"}),e.jsx("button",{onClick:()=>m(y.id),className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg text-sm font-medium hover:bg-red-50 transition-colors whitespace-nowrap",children:"Withdraw Application"})]})]},y.id))})]}),l.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Expired (",l.length,")"]}),e.jsx("div",{className:"space-y-4",children:l.map(y=>e.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6 opacity-75",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700",children:y.profileSnapshot.professionalInfo.specialty}),e.jsx("span",{className:"px-3 py-1 bg-gray-200 text-gray-600 text-xs font-medium rounded-full whitespace-nowrap",children:"Expired"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsxs("span",{children:[i(y.blockedDates.startDate)," - ",i(y.blockedDates.endDate)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-time-line"}),e.jsxs("span",{children:["Applied ",n(y.appliedAt)]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-red-600 mb-1",children:"No Response"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Expired ",n(y.reviewDeadline)]})]})]}),e.jsx("div",{className:"mt-4 bg-white border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("i",{className:"ri-unlock-line"}),e.jsx("span",{children:"Calendar dates have been automatically unblocked"})]})})]},y.id))})]}),h&&N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Application Details"}),e.jsx("button",{onClick:()=>{w(!1),D(null)},className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Status"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Status:"}),e.jsx("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded-full",children:N.status.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Applied:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(N.appliedAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Review Deadline:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(N.reviewDeadline)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Assignment Dates"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dates:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[i(N.blockedDates.startDate)," - ",i(N.blockedDates.endDate)]})]}),N.calendarBlocked&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-900",children:[e.jsx("i",{className:"ri-lock-line"}),e.jsx("span",{children:"Calendar blocked for these dates"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Submitted Profile"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Name:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:N.profileSnapshot.personalInfo.legalName})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Specialty:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:N.profileSnapshot.professionalInfo.specialty})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Experience:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[N.profileSnapshot.professionalInfo.yearsExperience," years"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Licenses:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:N.profileSnapshot.licensure.map(y=>y.state).join(", ")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Verification:"}),e.jsx("span",{className:`text-sm font-medium ${N.profileSnapshot.verificationStatus==="verified"?"text-green-600":"text-amber-600"}`,children:N.profileSnapshot.verificationStatus==="verified"?"✓ Verified":"Pending"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Notifications"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Application Received:"}),e.jsx("span",{className:N.notificationsSent.applicationReceived?"text-green-600":"text-gray-400",children:N.notificationsSent.applicationReceived?"✓ Sent":"Pending"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Facility Notified:"}),e.jsx("span",{className:"text-green-600",children:"✓ Sent"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{w(!1),D(null)},className:"w-full px-6 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors whitespace-nowrap",children:"Close"})})]})})]})}function fe(){const[s,a]=o.useState([]),[d,g]=o.useState(!0),[N,D]=o.useState(!1),[h,w]=o.useState(null);o.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:n}=await L.auth.getUser();if(!n.user){g(!1);return}const{data:r}=await L.from("physician_profiles").select("id").eq("user_id",n.user.id).maybeSingle();if(!r){g(!1);return}a([]),g(!1)}catch(n){console.error("Error fetching invited assignments:",n),g(!1)}},T=n=>{w(n),D(!0)},l=async n=>{try{a(r=>r.map(b=>b.id===n?{...b,status:"accepted_pending_signature"}:b))}catch(r){console.error("Error accepting invitation:",r),alert("Failed to accept invitation. Please try again.")}},i=async n=>{if(confirm("Are you sure you want to decline this invitation?"))try{a(r=>r.filter(b=>b.id!==n))}catch(r){console.error("Error declining invitation:",r),alert("Failed to decline invitation. Please try again.")}};return d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading invited assignments..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-checkbox-circle-line text-3xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Invited Assignments"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any facility invitations at this time."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"When facilities approve your applications, they'll appear here for you to review and accept."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.jsx("i",{className:"ri-checkbox-circle-line text-green-600"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-green-900",children:[e.jsx("strong",{children:"Congratulations!"})," These facilities have approved your application. Review and sign the required documents to confirm your assignment."]})})]}),s.map(n=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-teal-300 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between gap-4 mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:n.position}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${n.status==="invited"?"bg-green-100 text-green-700":n.status==="accepted_pending_signature"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:n.status==="invited"?"Invited":n.status==="accepted_pending_signature"?"Pending Signature":"Fully Executed"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[n.facilityName," • ",n.location]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsx("span",{children:n.dateRange})]}),e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-teal-600",children:[e.jsx("i",{className:"ri-money-dollar-circle-line"}),e.jsx("span",{children:n.pay})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Required Documents"}),e.jsx("div",{className:"space-y-2",children:n.documentsRequired.map(r=>{const b=n.documentsSigned.includes(r);return e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700",children:r}),b?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 font-medium",children:[e.jsx("i",{className:"ri-check-line"}),"Signed"]}):e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 font-medium",children:[e.jsx("i",{className:"ri-time-line"}),"Pending"]})]},r)})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[n.status==="invited"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>l(n.id),className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Accept Invitation"}),e.jsx("button",{onClick:()=>i(n.id),className:"px-4 py-2 border border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg text-sm font-medium transition-colors",children:"Decline"})]}),n.status==="accepted_pending_signature"&&e.jsxs("button",{onClick:()=>T(n),className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-file-text-line"}),"Review & Sign Documents"]})]}),e.jsxs("div",{className:"mt-4 flex items-start gap-2 text-xs text-gray-500",children:[e.jsx("i",{className:"ri-information-line mt-0.5"}),e.jsxs("p",{children:["Invited on ",new Date(n.invitedDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),". Both you and the facility must sign all documents to finalize the assignment."]})]})]},n.id))]}),N&&h&&e.jsx(be,{assignment:h,onClose:()=>{D(!1),w(null)},onComplete:(n,r)=>{a(b=>b.map(m=>m.id===n?{...m,documentsSigned:r}:m)),D(!1),w(null)}})]})}function be({assignment:s,onClose:a,onComplete:d}){const[g,N]=o.useState(0),[D,h]=o.useState(""),[w,A]=o.useState(!1),[T,l]=o.useState([...s.documentsSigned]),i=s.documentsRequired[g],n=g===s.documentsRequired.length-1,r=T.includes(i),b=async()=>{if(!D.trim()||!w){alert("Please enter your full legal name and agree to the terms.");return}try{const m=[...T,i];l(m),h(""),A(!1),n?d(s.id,m):N(g+1)}catch(m){console.error("Error signing document:",m),alert("Failed to sign document. Please try again.")}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Review & Sign Documents"}),e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Document ",g+1," of ",s.documentsRequired.length]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:i}),e.jsxs("div",{className:"prose prose-sm max-w-none text-gray-700 space-y-3",children:[e.jsx("p",{children:"Document preview will be displayed here. In production, this would show the actual document content or embed a PDF viewer."}),e.jsx("p",{children:e.jsx("strong",{children:"Assignment Details:"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Position: ",s.position]}),e.jsxs("li",{children:["Facility: ",s.facilityName]}),e.jsxs("li",{children:["Dates: ",s.dateRange]}),e.jsxs("li",{children:["Compensation: ",s.pay]})]})]})]}),!r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type your full legal name to sign"}),e.jsx("input",{type:"text",value:D,onChange:m=>h(m.target.value),placeholder:"Your Full Legal Name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"agree",checked:w,onChange:m=>A(m.target.checked),className:"mt-1 w-4 h-4 text-teal-600 border-gray-300 rounded focus:ring-teal-500"}),e.jsx("label",{htmlFor:"agree",className:"text-sm text-gray-700",children:"I have reviewed this document and agree to its terms. I understand this is a legally binding signature."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:b,disabled:!D.trim()||!w,className:"flex-1 bg-teal-600 hover:bg-teal-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition-colors",children:n?"Sign & Complete":"Sign & Continue"}),!n&&e.jsx("button",{onClick:()=>N(g+1),className:"px-6 py-3 border border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg font-medium transition-colors",children:"Skip for Now"})]})]}),r&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx("i",{className:"ri-check-circle-fill text-green-600 text-xl"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Document Signed"}),e.jsx("p",{className:"text-xs text-green-700",children:"This document has been signed and submitted."})]}),!n&&e.jsx("button",{onClick:()=>N(g+1),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"Next Document"})]})]})]})})}function ye(){const[s,a]=o.useState([]),[d,g]=o.useState(!0),[N,D]=o.useState(!1),[h,w]=o.useState(null);o.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:i}=await L.auth.getUser();if(!i.user){g(!1);return}const{data:n}=await L.from("physician_profiles").select("id").eq("user_id",i.user.id).maybeSingle();if(!n){g(!1);return}const{data:r,error:b}=await L.from("confirmed_assignments").select("*").eq("physician_id",n.id).gte("end_date",new Date().toISOString().split("T")[0]).order("start_date",{ascending:!0});if(b){console.error("Error fetching assignments:",b),g(!1);return}const m=(r||[]).map(v=>({id:v.id,facilityName:v.facility_name||"Unknown Facility",location:v.location||"",position:v.position||"",dateRange:`${new Date(v.start_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}-${new Date(v.end_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,startDate:v.start_date,endDate:v.end_date,pay:v.pay||"$0",status:v.status||"confirmed",facilityContact:v.facility_contact||{name:"",email:"",phone:""},address:v.address||"",notes:v.notes||""}));a(m),g(!1)}catch(i){console.error("Error fetching upcoming assignments:",i),g(!1)}},T=i=>{w(i),D(!0)},l=i=>{const n=new Date,b=new Date(i).getTime()-n.getTime();return Math.ceil(b/(1e3*60*60*24))};return d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading upcoming assignments..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-calendar-check-line text-3xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Upcoming Assignments"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any confirmed assignments scheduled."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.jsx("i",{className:"ri-calendar-check-line text-purple-600"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-purple-900",children:[e.jsx("strong",{children:"Confirmed Assignments:"})," These dates are locked in your calendar and cannot be double-booked. Contact the facility directly if you need to make changes."]})})]}),s.map(i=>{const n=l(i.startDate),r=n<=7&&n>0;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-teal-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:i.position}),e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded",children:"Confirmed"}),r&&e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs font-medium rounded",children:"Starting Soon"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[i.facilityName," • ",i.location]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsx("span",{children:i.dateRange})]}),e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-teal-600",children:[e.jsx("i",{className:"ri-money-dollar-circle-line"}),e.jsx("span",{children:i.pay})]})]})]}),e.jsx("button",{onClick:()=>T(i),className:"bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"View Details"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("i",{className:"ri-time-line text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-gray-600",children:"Starts in: "}),e.jsx("span",{className:"font-medium text-gray-900",children:n>0?`${n} days`:n===0?"Today":"In progress"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("i",{className:"ri-map-pin-line text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-gray-600",children:"Location: "}),e.jsx("span",{className:"font-medium text-gray-900",children:i.address})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("i",{className:"ri-user-line text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-gray-600",children:"Contact: "}),e.jsx("span",{className:"font-medium text-gray-900",children:i.facilityContact.name})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-start gap-2 text-xs text-gray-500",children:[e.jsx("i",{className:"ri-lock-line mt-0.5"}),e.jsx("p",{children:"These dates are locked in your calendar. To make changes, please contact the facility directly."})]})]},i.id)})]}),N&&h&&e.jsx(je,{assignment:h,onClose:()=>{D(!1),w(null)}})]})}function je({assignment:s,onClose:a}){return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Assignment Details"}),e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:s.position}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-building-line text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Facility"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.facilityName})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-map-pin-line text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-calendar-line text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Assignment Dates"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.dateRange})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-money-dollar-circle-line text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Compensation"}),e.jsx("p",{className:"font-medium text-teal-600 text-lg",children:s.pay})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Facility Contact"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("i",{className:"ri-user-line text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:s.facilityContact.name})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("i",{className:"ri-mail-line text-gray-400"}),e.jsx("a",{href:`mailto:${s.facilityContact.email}`,className:"text-teal-600 hover:text-teal-700",children:s.facilityContact.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("i",{className:"ri-phone-line text-gray-400"}),e.jsx("a",{href:`tel:${s.facilityContact.phone}`,className:"text-teal-600 hover:text-teal-700",children:s.facilityContact.phone})]})]})]}),s.notes&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Important Notes"}),e.jsx("p",{className:"text-sm text-blue-800",children:s.notes})]})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 bg-teal-600 hover:bg-teal-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Close"}),e.jsx("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg font-medium transition-colors whitespace-nowrap",children:"Add to Calendar"})]})]})]})})}function Ne(){const[s,a]=o.useState([]),[d,g]=o.useState(!0),[N,D]=o.useState(!1),[h,w]=o.useState(null);o.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:i}=await L.auth.getUser();if(!i.user){g(!1);return}const{data:n}=await L.from("physician_profiles").select("id").eq("user_id",i.user.id).maybeSingle();if(!n){g(!1);return}a([]),g(!1)}catch(i){console.error("Error fetching completed assignments:",i),g(!1)}},T=i=>{w(i),D(!0)},l=i=>{const n=document.createElement("input");n.type="file",n.accept=".pdf,.doc,.docx",n.onchange=()=>{a(r=>r.map(b=>b.id===i?{...b,invoiceUploaded:!0}:b)),alert("Invoice uploaded successfully!")},n.click()};return d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading completed assignments..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-check-double-line text-3xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Completed Assignments"}),e.jsx("p",{className:"text-gray-600",children:"Your completed assignments will appear here."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-check-double-line text-green-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700",children:"Total Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:s.length})]})]})}),e.jsx("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-money-dollar-circle-line text-teal-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-teal-700",children:"Total Earned"}),e.jsxs("p",{className:"text-2xl font-bold text-teal-900",children:["$",s.reduce((i,n)=>i+parseInt(n.pay.replace(/[$,]/g,"")),0).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-file-text-line text-orange-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-700",children:"Pending Invoices"}),e.jsx("p",{className:"text-2xl font-bold text-orange-900",children:s.filter(i=>!i.invoiceUploaded).length})]})]})})]}),s.map(i=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-teal-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:i.position}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${i.paymentStatus==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:i.paymentStatus==="paid"?"Paid":"Payment Pending"}),!i.invoiceUploaded&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded",children:"Invoice Required"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[i.facilityName," • ",i.location]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsx("span",{children:i.dateRange})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-check-line"}),e.jsxs("span",{children:["Completed ",new Date(i.completedDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 font-semibold text-teal-600",children:[e.jsx("i",{className:"ri-money-dollar-circle-line"}),e.jsx("span",{children:i.pay})]})]})]}),e.jsx("button",{onClick:()=>T(i),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"View Details"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[!i.invoiceUploaded&&e.jsxs("button",{onClick:()=>l(i.id),className:"flex items-center gap-2 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:[e.jsx("i",{className:"ri-upload-line"}),"Upload Invoice"]}),i.messages.length>0&&e.jsxs("button",{onClick:()=>T(i),className:"flex items-center gap-2 text-teal-600 hover:text-teal-700 text-sm font-medium",children:[e.jsx("i",{className:"ri-message-3-line"}),i.messages.length," Message",i.messages.length>1?"s":""]})]}),i.facilityFeedback&&e.jsxs("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3 flex items-start gap-2",children:[e.jsx("i",{className:"ri-star-fill text-green-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-green-900 mb-1",children:"Facility Feedback"}),e.jsx("p",{className:"text-sm text-green-800",children:i.facilityFeedback})]})]})]},i.id))]}),N&&h&&e.jsx(ve,{assignment:h,onClose:()=>{D(!1),w(null)},onUploadInvoice:l})]})}function ve({assignment:s,onClose:a,onUploadInvoice:d}){const[g,N]=o.useState(""),D=()=>{g.trim()&&(alert("Message sent to facility!"),N(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Completed Assignment Details"}),e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:s.position}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Facility"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.facilityName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Location"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.location})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Assignment Dates"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.dateRange})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Compensation"}),e.jsx("p",{className:"font-medium text-teal-600 text-lg",children:s.pay})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payment Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Payment Status:"}),e.jsx("span",{className:`font-medium ${s.paymentStatus==="paid"?"text-green-600":"text-orange-600"}`,children:s.paymentStatus==="paid"?"Paid":"Pending"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Invoice Status:"}),e.jsx("span",{className:`font-medium ${s.invoiceUploaded?"text-green-600":"text-red-600"}`,children:s.invoiceUploaded?"Uploaded":"Required"})]})]}),!s.invoiceUploaded&&e.jsxs("button",{onClick:()=>d(s.id),className:"w-full mt-3 bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-upload-line"}),"Upload Invoice"]})]}),s.facilityFeedback&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-star-fill text-green-600 text-xl mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-green-900 mb-1",children:"Facility Feedback"}),e.jsx("p",{className:"text-sm text-green-800",children:s.facilityFeedback})]})]})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Communication History"}),s.messages.length>0?e.jsx("div",{className:"space-y-3 mb-4",children:s.messages.map(h=>e.jsxs("div",{className:`p-3 rounded-lg ${h.sender==="physician"?"bg-teal-50 ml-8":"bg-gray-50 mr-8"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-900",children:h.senderName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(h.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]}),h.type==="document_request"&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded mb-1",children:"Document Request"}),e.jsx("p",{className:"text-sm text-gray-700",children:h.content})]},h.id))}):e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No messages yet."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:h=>N(h.target.value),placeholder:"Type a message to the facility...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",onKeyPress:h=>h.key==="Enter"&&D()}),e.jsx("button",{onClick:D,disabled:!g.trim(),className:"bg-teal-600 hover:bg-teal-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"Send"})]})]})]})]})})}const we=()=>{const[s,a]=o.useState([]),[d,g]=o.useState(null),[N,D]=o.useState(""),[h,w]=o.useState([]),[A,T]=o.useState("all");o.useEffect(()=>{},[]);const l=c=>{if(!c)return"";const S=new Date(c),k=new Date,F=k.getTime()-S.getTime(),$=Math.floor(F/6e4),I=Math.floor(F/36e5),t=Math.floor(F/864e5);return $<60?`${$} minutes ago`:I<24?`${I} hours ago`:t<7?`${t} days ago`:S.toLocaleDateString("en-US",{month:"short",day:"numeric",year:S.getFullYear()!==k.getFullYear()?"numeric":void 0})},i=c=>{switch(c){case"clarification":return"ri-question-line";case"document":return"ri-file-text-line";case"information":return"ri-information-line";default:return"ri-mail-line"}},n=c=>{switch(c){case"clarification":return"bg-blue-100 text-blue-700";case"document":return"bg-purple-100 text-purple-700";case"information":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},r=c=>{switch(c){case"pending":return e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded",children:"Pending Response"});case"responded":return e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:"Responded"});case"resolved":return e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded",children:"Resolved"});default:return null}},b=c=>{c.target.files&&w(Array.from(c.target.files))},m=()=>{if(!d||!N.trim())return;const c={id:`resp-${Date.now()}`,sender:"physician",message:N,attachments:h.map(S=>S.name),timestamp:new Date().toISOString()};a(S=>S.map(k=>k.id===d.id?{...k,status:"responded",responses:[...k.responses,c]}:k)),g(S=>S&&{...S,status:"responded",responses:[...S.responses,c]}),D(""),w([])},v=s.filter(c=>A==="all"?!0:c.status===A),y=s.filter(c=>c.status==="pending").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Facility Requests"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Respond to facility clarifications and document requests"})]}),y>0&&e.jsx("div",{className:"px-4 py-2 bg-yellow-100 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:[e.jsx("i",{className:"ri-alert-line mr-2"}),y," pending ",y===1?"request":"requests"]})})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-gray-200",children:["all","pending","responded","resolved"].map(c=>e.jsxs("button",{onClick:()=>T(c),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${A===c?"border-teal-600 text-teal-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[c.charAt(0).toUpperCase()+c.slice(1),c!=="all"&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:s.filter(S=>S.status===c).length})]},c))}),v.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-mail-check-line text-gray-400 text-3xl"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No requests found"}),e.jsx("p",{className:"text-sm text-gray-600",children:A==="all"?"You have no facility requests at this time.":`You have no ${A} requests.`})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:v.map(c=>e.jsxs("div",{onClick:()=>g(c),className:`bg-white rounded-lg border p-4 cursor-pointer transition-all ${d?.id===c.id?"border-teal-300 shadow-md":"border-gray-200 hover:border-teal-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${n(c.requestType)}`,children:e.jsx("i",{className:`${i(c.requestType)} text-lg`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:c.subject}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[c.facilityName," • ",c.assignmentTitle]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:c.message})]})]}),r(c.status)]}),c.requestedDocuments?.length&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Requested Documents:"}),e.jsx("ul",{className:"space-y-1",children:c.requestedDocuments.map((S,k)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-center gap-2",children:[e.jsx("i",{className:"ri-file-line text-gray-400"}),S]},k))})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[e.jsx("i",{className:"ri-time-line mr-1"}),l(c.createdAt)]}),c.responses.length>0&&e.jsxs("span",{children:[e.jsx("i",{className:"ri-message-3-line mr-1"}),c.responses.length," ",c.responses.length===1?"reply":"replies"]})]})]},c.id))}),d?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col h-[600px] sticky top-4",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:d.subject}),r(d.status)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[d.facilityName," • ",d.assignmentTitle]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"ri-building-line text-gray-600 text-sm"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:d.facilityName}),e.jsx("p",{className:"text-sm text-gray-700",children:d.message}),d.requestedDocuments?.length&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Requested Documents:"}),e.jsx("ul",{className:"space-y-1",children:d.requestedDocuments.map((c,S)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-center gap-2",children:[e.jsx("i",{className:"ri-file-line text-gray-400"}),c]},S))})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l(d.createdAt)})]})]}),d.responses.map(c=>e.jsxs("div",{className:`flex gap-3 ${c.sender==="physician"?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${c.sender==="physician"?"bg-teal-100":"bg-gray-200"}`,children:e.jsx("i",{className:`${c.sender==="physician"?"ri-user-line text-teal-600":"ri-building-line text-gray-600"} text-sm`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:`rounded-lg p-3 ${c.sender==="physician"?"bg-teal-50":"bg-gray-50"}`,children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:c.sender==="physician"?"You":d.facilityName}),e.jsx("p",{className:"text-sm text-gray-700",children:c.message}),c.attachments?.length&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Attachments:"}),e.jsx("div",{className:"space-y-1",children:c.attachments.map((S,k)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("i",{className:"ri-attachment-line text-gray-400"}),S]},k))})]})]}),e.jsx("p",{className:`text-xs text-gray-500 mt-1 ${c.sender==="physician"?"text-right":""}`,children:l(c.timestamp)})]})]},c.id))]}),d.status!=="resolved"&&e.jsxs("div",{className:"p-4 border-t border-gray-200",children:[e.jsx("textarea",{value:N,onChange:c=>D(c.target.value),placeholder:"Type your response...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 resize-none"}),h.length>0&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Attached Files:"}),e.jsx("div",{className:"space-y-1",children:h.map((c,S)=>e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:[e.jsx("i",{className:"ri-file-line mr-1"}),c.name]}),e.jsx("button",{onClick:()=>w(k=>k.filter((F,$)=>$!==S)),className:"text-red-600 hover:text-red-700",children:e.jsx("i",{className:"ri-close-line"})})]},S))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",multiple:!0,onChange:b,className:"hidden"}),e.jsxs("span",{className:"text-sm text-teal-600 hover:text-teal-700 font-medium",children:[e.jsx("i",{className:"ri-attachment-line mr-1"}),"Attach Files"]})]}),e.jsxs("button",{onClick:m,disabled:!N.trim(),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap ${N.trim()?"bg-teal-600 text-white hover:bg-teal-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx("i",{className:"ri-send-plane-fill mr-2"}),"Send Reply"]})]})]})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 flex items-center justify-center h-[600px] sticky top-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-message-3-line text-gray-400 text-3xl"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select a request to view the conversation"})]})})]})]})},q=[{id:"current_coverage",question:"Do you currently have malpractice insurance?",type:"boolean",required:!0},{id:"current_provider",question:"Current insurance provider (if applicable)",type:"text",required:!1},{id:"coverage_type",question:"Preferred coverage type",type:"select",options:["Claims-Made","Occurrence","Tail Coverage","Not Sure"],required:!0},{id:"coverage_amount",question:"Desired coverage amount",type:"select",options:["$1M / $3M","$2M / $4M","$3M / $5M","Other"],required:!0},{id:"specialty_coverage",question:"Do you require specialty-specific coverage?",type:"boolean",required:!0},{id:"specialty_details",question:"Specialty coverage details",type:"textarea",required:!1},{id:"claims_history",question:"Have you had any malpractice claims in the past 10 years?",type:"boolean",required:!0},{id:"claims_details",question:"Claims history details (if applicable)",type:"textarea",required:!1},{id:"license_sanctions",question:"Have you ever had license sanctions or disciplinary actions?",type:"boolean",required:!0},{id:"sanctions_details",question:"Sanctions/disciplinary details (if applicable)",type:"textarea",required:!1}],De=[{id:"quote-1",provider:"MedPro Group",assignmentId:"assign-001",assignmentTitle:"Emergency Medicine - Memorial Hospital",coverageType:"Claims-Made",coverageAmount:"$1M / $3M",premium:"$4,200/year",deductible:"$5,000",effectiveDate:"2025-02-01",expirationDate:"2026-02-01",status:"pending",submittedDate:"2025-01-15",details:"Comprehensive coverage for emergency medicine with tail coverage option available. Includes legal defense costs and risk management resources."},{id:"quote-2",provider:"The Doctors Company",coverageType:"Occurrence",coverageAmount:"$2M / $4M",premium:"$5,800/year",deductible:"$10,000",effectiveDate:"2025-02-01",expirationDate:"2026-02-01",status:"pending",submittedDate:"2025-01-18",details:"Occurrence-based policy with no tail coverage needed. Includes consent-to-settle clause and 24/7 risk management hotline."}];function Se(){const[s,a]=o.useState({}),[d,g]=o.useState(De),[N,D]=o.useState(!1),h=(l,i)=>{a(n=>({...n,[l]:i})),D(!1)},w=()=>{console.log("Saving insurance answers:",s),D(!0),setTimeout(()=>D(!1),3e3)},A=(l,i)=>{g(n=>n.map(r=>r.id===l?{...r,status:i==="accept"?"accepted":"declined"}:r))},T=q.filter(l=>l.required).every(l=>s[l.id]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Insurance Questionnaire"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Answer these questions once. Your responses will be reusable across all assignments."})]}),e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 text-xs font-medium rounded-full",children:"Reusable"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[q.map(l=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900",children:[l.question,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.type==="boolean"&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:l.id,value:"yes",checked:s[l.id]==="yes",onChange:i=>h(l.id,i.target.value),className:"w-4 h-4 text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Yes"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:l.id,value:"no",checked:s[l.id]==="no",onChange:i=>h(l.id,i.target.value),className:"w-4 h-4 text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No"})]})]}),l.type==="text"&&e.jsx("input",{type:"text",value:s[l.id]||"",onChange:i=>h(l.id,i.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",placeholder:"Enter your answer"}),l.type==="select"&&l.options&&e.jsxs("select",{value:s[l.id]||"",onChange:i=>h(l.id,i.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Select an option"}),l.options.map(i=>e.jsx("option",{value:i,children:i},i))]}),l.type==="textarea"&&e.jsx("textarea",{value:s[l.id]||"",onChange:i=>h(l.id,i.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm resize-none",placeholder:"Provide details"}),l.type==="date"&&e.jsx("input",{type:"date",value:s[l.id]||"",onChange:i=>h(l.id,i.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"})]},l.id)),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:T?e.jsxs("span",{className:"flex items-center text-green-600",children:[e.jsx("i",{className:"ri-checkbox-circle-fill mr-2"}),"All required questions answered"]}):e.jsxs("span",{className:"flex items-center text-amber-600",children:[e.jsx("i",{className:"ri-error-warning-fill mr-2"}),"Please answer all required questions"]})}),e.jsx("button",{onClick:w,disabled:!T,className:"px-6 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:N?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Saved"]}):"Save Answers"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Insurance Quotes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Review and respond to insurance quotes from providers"})]}),e.jsx("div",{className:"p-6",children:d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-file-shield-2-line text-3xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No quotes yet"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Insurance providers will submit quotes based on your questionnaire responses"})]}):e.jsx("div",{className:"space-y-4",children:d.map(l=>e.jsxs("div",{className:`border rounded-lg p-6 ${l.status==="accepted"?"border-green-200 bg-green-50":l.status==="declined"?"border-gray-200 bg-gray-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l.provider}),l.assignmentTitle&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["For: ",l.assignmentTitle]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Submitted: ",new Date(l.submittedDate).toLocaleDateString()]})]}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full whitespace-nowrap ${l.status==="pending"?"bg-amber-100 text-amber-700":l.status==="accepted"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:l.status==="pending"?"Pending Review":l.status==="accepted"?"Accepted":"Declined"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Coverage Type"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.coverageType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Coverage Amount"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.coverageAmount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Premium"}),e.jsx("p",{className:"text-sm font-medium text-teal-600",children:l.premium})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Deductible"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.deductible})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Coverage Period"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[new Date(l.effectiveDate).toLocaleDateString()," -"," ",new Date(l.expirationDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Quote Details"}),e.jsx("p",{className:"text-sm text-gray-700",children:l.details})]}),l.status==="pending"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>A(l.id,"accept"),className:"flex-1 px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Accept Quote"]}),e.jsxs("button",{onClick:()=>A(l.id,"decline"),className:"flex-1 px-4 py-2 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Decline Quote"]})]}),l.status==="accepted"&&e.jsxs("div",{className:"flex items-center text-sm text-green-700",children:[e.jsx("i",{className:"ri-checkbox-circle-fill mr-2"}),"You accepted this quote"]}),l.status==="declined"&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("i",{className:"ri-close-circle-fill mr-2"}),"You declined this quote"]})]},l.id))})})]})]})}const ke=(s,a,d)=>{const g={id:`request-${Date.now()}`,type:"insurance",physicianId:s,physicianName:"Current Physician",assignmentId:a,status:"submitted",requestDetails:d,profileShared:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),auditLog:[{timestamp:new Date().toISOString(),action:"request_created",actor:s,details:`Insurance request submitted for assignment ${a}`},{timestamp:new Date().toISOString(),action:"profile_shared",actor:"system",details:"Verified profile automatically shared with approved insurance vendors"}]};return console.log("Insurance request submitted:",g),g},Ce=(s,a,d)=>{const g={id:`request-${Date.now()}`,type:"travel",physicianId:s,physicianName:"Current Physician",assignmentId:a,status:"submitted",requestDetails:d,profileShared:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),auditLog:[{timestamp:new Date().toISOString(),action:"request_created",actor:s,details:`Travel request submitted for assignment ${a}`},{timestamp:new Date().toISOString(),action:"profile_shared",actor:"system",details:"Travel preferences shared with approved travel vendors"}]};return console.log("Travel request submitted:",g),g},Ae=(s,a,d)=>{const g=new Date().toISOString();console.log("Quote accepted:",{quoteId:s,physicianId:a,requestId:d,timestamp:g,status:"accepted"}),Ie(d,"accepted"),Pe(s,a),Re(s)},Te=(s,a,d)=>{console.log("Quote declined:",{quoteId:s,physicianId:a,reason:d,timestamp:new Date().toISOString(),status:"declined"}),_e(s,d)},Ie=(s,a)=>{console.log("Service request status updated:",{requestId:s,status:a,timestamp:new Date().toISOString()})},Pe=(s,a)=>{console.log("Platform fee transaction logged:",{quoteId:s,physicianId:a,feePercentage:15,timestamp:new Date().toISOString()})},Re=s=>{console.log("Notification sent: Quote accepted",{quoteId:s})},_e=(s,a)=>{console.log("Notification sent: Quote declined",{quoteId:s,reason:a})};function $e(){const s="physician-001",[a,d]=o.useState(oe(s)),[g]=o.useState(me),[N]=o.useState(xe),[D,h]=o.useState(!1),[w,A]=o.useState(!0),[T,l]=o.useState("insurance"),[i,n]=o.useState({assignmentId:"",coverageType:"Claims-Made",coverageAmount:1e6,specialty:"Emergency Medicine",statesLicensed:[],priorClaims:!1,additionalRequirements:""}),[r,b]=o.useState({assignmentId:"",serviceType:"full_package",departureCity:"",destinationCity:"",departureDate:"",returnDate:"",flightClass:"Economy Plus",hotelType:"Extended Stay",carRental:!1,airlinePreference:"",hotelChain:"",specialRequests:""}),m=(t,j,u)=>{Ae(t,s,j),d(x=>x.map(B=>B.id===j?{...B,status:"accepted",quoteId:t,purchasedAt:new Date().toISOString()}:B)),alert(`Quote accepted! ${u==="insurance"?"Insurance coverage":"Travel arrangements"} will be processed.`)},v=(t,j)=>{const u=prompt("Optional: Provide a reason for declining this quote");Te(t,s,u||void 0),alert("Quote declined. The vendor has been notified.")},y=()=>{if(!w){alert("Please authorize data sharing with approved vendors");return}if(!i.assignmentId){alert("Please select an assignment");return}const t=ke(s,i.assignmentId,i);d(j=>[t,...j]),h(!1),n({assignmentId:"",coverageType:"Claims-Made",coverageAmount:1e6,specialty:"Emergency Medicine",statesLicensed:[],priorClaims:!1,additionalRequirements:""}),alert("Insurance request submitted! Approved vendors will review your profile and submit quotes within 24-48 hours.")},c=()=>{if(!w){alert("Please authorize data sharing with approved vendors");return}if(!r.assignmentId||!r.departureCity||!r.destinationCity){alert("Please fill in all required fields");return}const t=Ce(s,r.assignmentId,{serviceType:r.serviceType,departureCity:r.departureCity,destinationCity:r.destinationCity,travelDates:{departure:r.departureDate,return:r.returnDate},preferences:{flightClass:r.flightClass,hotelType:r.hotelType,carRental:r.carRental,airlinePreference:r.airlinePreference,hotelChain:r.hotelChain,specialRequests:r.specialRequests}});d(j=>[t,...j]),h(!1),b({assignmentId:"",serviceType:"full_package",departureCity:"",destinationCity:"",departureDate:"",returnDate:"",flightClass:"Economy Plus",hotelType:"Extended Stay",carRental:!1,airlinePreference:"",hotelChain:"",specialRequests:""}),alert("Travel request submitted! Approved vendors will review your preferences and submit quotes within 24-48 hours.")},S=t=>t==="insurance"?"ri-shield-check-line":"ri-flight-takeoff-line",k=t=>t==="insurance"?"Malpractice Insurance":"Travel & Lodging",F=t=>{switch(t){case"draft":return"bg-gray-100 text-gray-700";case"submitted":return"bg-blue-100 text-blue-700";case"vendor_reviewing":return"bg-purple-100 text-purple-700";case"quote_received":return"bg-teal-100 text-teal-700";case"accepted":return"bg-green-100 text-green-700";case"in_progress":return"bg-indigo-100 text-indigo-700";case"completed":return"bg-emerald-100 text-emerald-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},$=t=>{switch(t){case"draft":return"Draft";case"submitted":return"Submitted";case"vendor_reviewing":return"Under Review";case"quote_received":return"Quote Received";case"accepted":return"Accepted";case"in_progress":return"In Progress";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return t}},I=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t);return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-shield-check-line text-2xl text-teal-600"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-teal-900 mb-2",children:"Secure Data Sharing"}),e.jsx("p",{className:"text-sm text-teal-800 mb-4",children:"Your verified profile and preferences are only shared with approved third‑party vendors when you explicitly request services. All vendors are vetted and monitored by the platform."}),e.jsxs("label",{className:"flex items-start cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:t=>A(t.target.checked),className:"w-4 h-4 text-teal-600 focus:ring-teal-500 rounded mt-0.5"}),e.jsx("span",{className:"ml-3 text-sm text-teal-900",children:"I authorize the platform to securely share my verified profile with approved vendors only when I request services. Platform fee: 15% of service cost."})]})]})]})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>{l("insurance"),h(!0)},disabled:!w,className:"flex-1 px-6 py-4 bg-white border-2 border-teal-600 text-teal-600 font-medium rounded-lg hover:bg-teal-50 disabled:bg-gray-100 disabled:border-gray-300 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx("i",{className:"ri-shield-check-line text-xl mr-2"}),"Request Insurance Quote"]}),e.jsxs("button",{onClick:()=>{l("travel"),h(!0)},disabled:!w,className:"flex-1 px-6 py-4 bg-white border-2 border-teal-600 text-teal-600 font-medium rounded-lg hover:bg-teal-50 disabled:bg-gray-100 disabled:border-gray-300 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx("i",{className:"ri-flight-takeoff-line text-xl mr-2"}),"Request Travel Services"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Service Requests"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track insurance and travel service requests tied to your assignments"})]}),e.jsx("div",{className:"p-6",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-customer-service-2-line text-3xl text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No service requests yet"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Request malpractice insurance or travel services for your assignments"})]}):e.jsx("div",{className:"space-y-6",children:a.map(t=>{const j=t.type==="insurance"?ue(t.id):[],u=t.type==="travel"?he(t.id):[];return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-white hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:`${S(t.type)} text-2xl text-teal-600`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:k(t.type)}),t.assignmentDetails&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.assignmentDetails.facilityName}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.assignmentDetails.location," • ",t.assignmentDetails.startDate," to ",t.assignmentDetails.endDate]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Requested: ",new Date(t.createdAt).toLocaleDateString()]})]})]}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full whitespace-nowrap ${F(t.status)}`,children:$(t.status)})]}),t.profileShared&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-shield-check-line text-blue-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-blue-900",children:"Verified Profile Shared Securely"}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Your profile has been shared with approved ",t.type," vendors"]})]})]})}),t.type==="insurance"&&j.length>0&&e.jsxs("div",{className:"space-y-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900",children:["Insurance Quotes (",j.length,")"]}),j.map(x=>e.jsxs("div",{className:"border-2 border-teal-200 rounded-lg p-4 bg-teal-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:x.vendorName}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[x.coverageType," • ",I(x.coverageAmount)," Coverage"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Submitted: ",new Date(x.submittedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Premium"}),e.jsx("p",{className:"text-lg font-bold text-teal-600",children:I(x.premium)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["+ ",I(x.platformFee)," platform fee"]}),e.jsxs("p",{className:"text-xs font-semibold text-gray-900 mt-1",children:["Total: ",I(x.totalCost)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Policy Term:"}),e.jsx("span",{className:"ml-2 font-medium text-gray-900",children:x.policyTerm})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Deductible:"}),e.jsx("span",{className:"ml-2 font-medium text-gray-900",children:I(x.deductible)})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Coverage Period:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[new Date(x.coverageStartDate).toLocaleDateString()," - ",new Date(x.coverageEndDate).toLocaleDateString()]})]})]}),x.additionalBenefits.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 mb-1",children:"Benefits:"}),e.jsx("ul",{className:"text-xs text-gray-700 space-y-1",children:x.additionalBenefits.map((B,E)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-check-line text-green-600 mr-1 mt-0.5"}),B]},E))})]}),x.notes&&e.jsxs("p",{className:"text-xs text-gray-700 mb-3 italic",children:["Note: ",x.notes]}),x.status==="submitted"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(x.id,t.id,"insurance"),className:"flex-1 px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Accept Quote"]}),e.jsxs("button",{onClick:()=>v(x.id),className:"flex-1 px-4 py-2 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Decline"]})]}),x.status==="accepted"&&e.jsxs("div",{className:"flex items-center text-sm text-green-700 bg-green-100 px-3 py-2 rounded-lg",children:[e.jsx("i",{className:"ri-checkbox-circle-fill mr-2"}),"Coverage purchased - Policy will be active on ",new Date(x.coverageStartDate).toLocaleDateString()]})]},x.id))]}),t.type==="travel"&&u.length>0&&e.jsxs("div",{className:"space-y-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900",children:["Travel Quotes (",u.length,")"]}),u.map(x=>e.jsxs("div",{className:"border-2 border-blue-200 rounded-lg p-4 bg-blue-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:x.vendorName}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1 capitalize",children:[x.serviceType.replace("_"," ")," Package"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Submitted: ",new Date(x.submittedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Service Cost"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:I(x.totalServiceCost)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["+ ",I(x.platformFee)," platform fee"]}),e.jsxs("p",{className:"text-xs font-semibold text-gray-900 mt-1",children:["Total: ",I(x.totalCost)]})]})]}),x.flightDetails&&e.jsxs("div",{className:"mb-3 p-3 bg-white rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx("i",{className:"ri-flight-takeoff-line mr-1"}),"Flight Details"]}),e.jsxs("div",{className:"text-xs text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Route:"})," ",x.flightDetails.departure," → ",x.flightDetails.arrival]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Dates:"})," ",new Date(x.flightDetails.departureDate).toLocaleDateString()," - ",new Date(x.flightDetails.returnDate).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Airline:"})," ",x.flightDetails.airline," (",x.flightDetails.flightNumber,")"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Class:"})," ",x.flightDetails.class," • ",I(x.flightDetails.price)]})]})]}),x.hotelDetails&&e.jsxs("div",{className:"mb-3 p-3 bg-white rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx("i",{className:"ri-hotel-line mr-1"}),"Hotel Details"]}),e.jsxs("div",{className:"text-xs text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Hotel:"})," ",x.hotelDetails.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Address:"})," ",x.hotelDetails.address]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Dates:"})," ",new Date(x.hotelDetails.checkIn).toLocaleDateString()," - ",new Date(x.hotelDetails.checkOut).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Room:"})," ",x.hotelDetails.roomType," • ",x.hotelDetails.totalNights," nights"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Price:"})," ",I(x.hotelDetails.pricePerNight),"/night • Total: ",I(x.hotelDetails.totalPrice)]})]})]}),x.carRentalDetails&&e.jsxs("div",{className:"mb-3 p-3 bg-white rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx("i",{className:"ri-car-line mr-1"}),"Car Rental Details"]}),e.jsxs("div",{className:"text-xs text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Company:"})," ",x.carRentalDetails.company]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"})," ",x.carRentalDetails.vehicleType]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Dates:"})," ",new Date(x.carRentalDetails.pickupDate).toLocaleDateString()," - ",new Date(x.carRentalDetails.returnDate).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Price:"})," ",I(x.carRentalDetails.price)]})]})]}),x.notes&&e.jsxs("p",{className:"text-xs text-gray-700 mb-3 italic",children:["Note: ",x.notes]}),x.status==="submitted"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(x.id,t.id,"travel"),className:"flex-1 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Accept Quote"]}),e.jsxs("button",{onClick:()=>v(x.id),className:"flex-1 px-4 py-2 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Decline"]})]}),x.status==="accepted"&&e.jsxs("div",{className:"flex items-center text-sm text-green-700 bg-green-100 px-3 py-2 rounded-lg",children:[e.jsx("i",{className:"ri-checkbox-circle-fill mr-2"}),"Travel arrangements confirmed - Vendor will fulfill independently"]})]},x.id))]}),t.auditLog&&t.auditLog.length>0&&e.jsxs("details",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("summary",{className:"text-xs font-medium text-gray-600 cursor-pointer hover:text-gray-900",children:["View Activity Log (",t.auditLog.length," events)"]}),e.jsx("div",{className:"mt-3 space-y-2",children:t.auditLog.map((x,B)=>e.jsxs("div",{className:"text-xs text-gray-600 flex items-start",children:[e.jsx("i",{className:"ri-time-line mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:x.action.replace(/_/g," ")}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:x.details}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"text-gray-500",children:new Date(x.timestamp).toLocaleString()})]})]},B))})]})]},t.id)})})})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:T==="insurance"?"Request Insurance Quote":"Request Travel Services"}),e.jsx("button",{onClick:()=>h(!1),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[T==="insurance"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Assignment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.assignmentId,onChange:t=>n(j=>({...j,assignmentId:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Select an assignment"}),e.jsx("option",{value:"assignment-001",children:"Emergency Medicine - Boston General Hospital (Jul 1 - Sep 30)"}),e.jsx("option",{value:"assignment-002",children:"Internal Medicine - City Medical Center (Aug 15 - Nov 15)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Coverage Type"}),e.jsxs("select",{value:i.coverageType,onChange:t=>n(j=>({...j,coverageType:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"Claims-Made",children:"Claims-Made Policy"}),e.jsx("option",{value:"Occurrence",children:"Occurrence Policy"}),e.jsx("option",{value:"Per-Diem",children:"Per-Diem Policy"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Coverage Amount"}),e.jsxs("select",{value:i.coverageAmount,onChange:t=>n(j=>({...j,coverageAmount:Number(t.target.value)})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:1e6,children:"$1,000,000"}),e.jsx("option",{value:2e6,children:"$2,000,000"}),e.jsx("option",{value:3e6,children:"$3,000,000"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Prior Claims"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!i.priorClaims,onChange:()=>n(t=>({...t,priorClaims:!1})),className:"w-4 h-4 text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No prior claims"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",checked:i.priorClaims,onChange:()=>n(t=>({...t,priorClaims:!0})),className:"w-4 h-4 text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Have prior claims"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Additional Requirements"}),e.jsx("textarea",{value:i.additionalRequirements,onChange:t=>n(j=>({...j,additionalRequirements:t.target.value})),rows:3,placeholder:"e.g., Need tail coverage, multi-state coverage, specific policy features...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm resize-none"})]})]}),T==="travel"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Assignment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.assignmentId,onChange:t=>b(j=>({...j,assignmentId:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Select an assignment"}),e.jsx("option",{value:"assignment-001",children:"Emergency Medicine - Boston General Hospital (Jul 1 - Sep 30)"}),e.jsx("option",{value:"assignment-002",children:"Internal Medicine - City Medical Center (Aug 15 - Nov 15)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Service Type"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{value:"full_package",label:"Full Package",icon:"ri-suitcase-line"},{value:"flight",label:"Flight Only",icon:"ri-flight-takeoff-line"},{value:"hotel",label:"Hotel Only",icon:"ri-hotel-line"},{value:"car_rental",label:"Car Rental",icon:"ri-car-line"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>b(j=>({...j,serviceType:t.value})),className:`p-3 border-2 rounded-lg text-center transition-all ${r.serviceType===t.value?"border-teal-600 bg-teal-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${t.icon} text-xl ${r.serviceType===t.value?"text-teal-600":"text-gray-400"}`}),e.jsx("p",{className:`text-xs font-medium mt-1 ${r.serviceType===t.value?"text-teal-900":"text-gray-700"}`,children:t.label})]},t.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Departure City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.departureCity,onChange:t=>b(j=>({...j,departureCity:t.target.value})),placeholder:"e.g., Los Angeles",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Destination City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.destinationCity,onChange:t=>b(j=>({...j,destinationCity:t.target.value})),placeholder:"e.g., Boston",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Departure Date"}),e.jsx("input",{type:"date",value:r.departureDate,onChange:t=>b(j=>({...j,departureDate:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Return Date"}),e.jsx("input",{type:"date",value:r.returnDate,onChange:t=>b(j=>({...j,returnDate:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Flight Class Preference"}),e.jsxs("select",{value:r.flightClass,onChange:t=>b(j=>({...j,flightClass:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Economy Plus",children:"Economy Plus"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"First",children:"First Class"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Hotel Type Preference"}),e.jsxs("select",{value:r.hotelType,onChange:t=>b(j=>({...j,hotelType:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"Extended Stay",children:"Extended Stay"}),e.jsx("option",{value:"Luxury",children:"Luxury"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Special Requests"}),e.jsx("textarea",{value:r.specialRequests,onChange:t=>b(j=>({...j,specialRequests:t.target.value})),rows:3,placeholder:"e.g., Airline loyalty program, hotel chain preference, parking needs, accessibility requirements...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm resize-none"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium mb-1",children:"Vendor Service Notice"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Services are provided by approved third‑party vendors. The platform monitors vendor performance but does not directly provide, underwrite, or guarantee these services. A 15% platform fee applies to all vendor services."})]})]})})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex gap-3 sticky bottom-0 bg-white",children:[e.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-6 py-3 bg-white border border-gray-300 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:"Cancel"}),e.jsx("button",{onClick:T==="insurance"?y:c,className:"flex-1 px-6 py-3 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors whitespace-nowrap",children:"Submit Request"})]})]})})]})}function Me({physicianId:s}){const{profile:a,isProfileComplete:d,completionPercentage:g}=W(),[N,D]=o.useState(ee),[h,w]=o.useState(se),[A,T]=o.useState(te),[l,i]=o.useState(null),[n,r]=o.useState(!1),[b,m]=o.useState(""),[v,y]=o.useState("all"),[c,S]=o.useState("date"),k=N.filter(u=>u.status==="open").filter(u=>v==="all"||u.specialty===v).sort((u,x)=>c==="date"?new Date(u.startDate).getTime()-new Date(x.startDate).getTime():x.payAmount-u.payAmount),F=Array.from(new Set(N.map(u=>u.specialty))),$=u=>{if(i(u),m(""),!d){m(`Profile incomplete (${g}% complete). You must complete all required sections before applying.`),r(!0);return}r(!0)},I=async()=>{if(!(!l||!a))try{if(!d){m(`Cannot apply. Profile is only ${g}% complete. Please complete all required sections.`);return}if(ae(s,l.startDate,l.endDate,h,A).hasOverlap){m("Cannot apply. You have overlapping applications or assignments for these dates.");return}const x=await le(),B=ie(),E={personalInfo:{legalName:a.personalIdentifiers?`${a.personalIdentifiers.firstName} ${a.personalIdentifiers.lastName}`:"Unknown",dateOfBirth:a.personalIdentifiers?.dateOfBirth||"",ssnLastFour:a.personalIdentifiers?.ssnLastFour||"",contactInfo:{phone:a.personalIdentifiers?.phoneNumber||"",email:"",address:a.personalIdentifiers?.address||{line1:"",line2:"",city:"",state:"",zipCode:""}}},professionalInfo:{npiNumber:a.professionalInformation?.npiNumber||"",deaNumber:a.professionalInformation?.deaNumber||"",specialty:a.professionalInformation?.specialty||"",subspecialty:a.professionalInformation?.subspecialty||"",yearsExperience:a.professionalInformation?.yearsExperience||0,boardCertified:a.professionalInformation?.boardCertified||!1},licenses:a.licenses||[],documents:a.documents||[],questionnaires:a.questionnaires||[],digitalSignature:a.digitalSignature||null,capturedAt:new Date().toISOString(),ipAddress:x,deviceInfo:B},U=new Date,z=re(U,72),O={id:`app_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,jobPostingId:l.id,physicianId:s,physicianName:E.personalInfo.legalName,physicianSpecialty:E.professionalInfo.specialty,status:"pending",appliedAt:U.toISOString(),reviewDeadline:z,calendarBlocked:!0,blockedDates:{startDate:l.startDate,endDate:l.endDate},profileSnapshot:E,notificationsSent:{applicationReceived:!1,reminderSent:!1,deadlineWarning:!1,decision:!1}},Q=ne(s,O.id,l.id,l.startDate,l.endDate,z);w([...h,O]),T([...A,Q]),console.log("Application submitted:",O),console.log("Calendar blocked:",Q),console.log("Facility notification sent"),console.log("Physician confirmation sent"),r(!1),i(null),alert("Application submitted successfully! The facility has 72 hours to review. Your calendar has been blocked for these dates.")}catch(u){console.error("Application error:",u),m("An error occurred while submitting your application. Please try again.")}},t=u=>new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),j=u=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(u);return e.jsxs("div",{className:"space-y-6",children:[!d&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-error-warning-line text-xl text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Profile Incomplete - Cannot Apply"}),e.jsxs("p",{className:"text-sm text-red-700 mb-2",children:["You must complete your profile before applying to assignments. Your profile is currently ",g,"% complete."]}),e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Complete all required sections to unlock the ability to apply."})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Specialty"}),e.jsxs("select",{value:v,onChange:u=>y(u.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500",children:[e.jsx("option",{value:"all",children:"All Specialties"}),F.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Sort By"}),e.jsxs("select",{value:c,onChange:u=>S(u.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500",children:[e.jsx("option",{value:"date",children:"Start Date"}),e.jsx("option",{value:"pay",children:"Pay Amount"})]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[k.length," ",k.length===1?"assignment":"assignments"," available"]})]})}),e.jsxs("div",{className:"space-y-4",children:[k.map(u=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:border-teal-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u.facilityName}),e.jsx("span",{className:"px-3 py-1 bg-teal-100 text-teal-700 text-xs font-medium rounded-full whitespace-nowrap",children:u.specialty}),u.subspecialty&&e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full whitespace-nowrap",children:u.subspecialty})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),e.jsxs("span",{children:[t(u.startDate)," - ",t(u.endDate)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-time-line"}),e.jsxs("span",{children:[u.blockDuration," days"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-map-pin-line"}),e.jsxs("span",{children:[u.requiredLicenses.join(", ")," license required"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-teal-600 mb-1",children:j(u.payAmount)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total compensation"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:u.requirements})}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`ri-shield-check-line ${u.malpracticeIncluded?"text-green-600":"text-gray-400"}`}),e.jsxs("span",{className:u.malpracticeIncluded?"text-green-700":"text-gray-500",children:["Malpractice ",u.malpracticeIncluded?"Included":"Not Included"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`ri-flight-takeoff-line ${u.travelIncluded?"text-green-600":"text-gray-400"}`}),e.jsxs("span",{className:u.travelIncluded?"text-green-700":"text-gray-500",children:["Travel ",u.travelIncluded?"Included":"Not Included"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`ri-hotel-line ${u.lodgingIncluded?"text-green-600":"text-gray-400"}`}),e.jsxs("span",{className:u.lodgingIncluded?"text-green-700":"text-gray-500",children:["Lodging ",u.lodgingIncluded?"Included":"Not Included"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Posted ",t(u.createdAt)]}),e.jsx("button",{onClick:()=>$(u),disabled:!d,className:`px-6 py-2 rounded-lg font-medium whitespace-nowrap transition-colors ${d?"bg-teal-600 text-white hover:bg-teal-700 cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:d?"Apply Now":"Complete Profile to Apply"})]})]},u.id)),k.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("i",{className:"ri-briefcase-line text-5xl text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No assignments found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your filters or check back later for new opportunities."})]})]}),n&&l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Apply to Assignment"}),e.jsx("button",{onClick:()=>{r(!1),i(null),m("")},className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-error-warning-line text-xl text-red-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-900 mb-1",children:"Cannot Submit Application"}),e.jsx("p",{className:"text-sm text-red-700",children:b})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Assignment Details"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Facility:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:l.facilityName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Specialty:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:l.specialty})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dates:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[t(l.startDate)," - ",t(l.endDate)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Compensation:"}),e.jsx("span",{className:"text-sm font-medium text-teal-600",children:j(l.payAmount)})]})]})]}),d&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Application Terms"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-blue-900",children:[e.jsx("strong",{children:"Calendar Block:"})," These dates will be automatically blocked on your calendar upon submission."]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"ri-time-line text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-blue-900",children:[e.jsx("strong",{children:"Review Period:"})," The facility has 72 hours to review your application."]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"ri-lock-line text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-blue-900",children:[e.jsx("strong",{children:"Temporary Lock:"})," You cannot apply to overlapping assignments during the review period."]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"ri-refresh-line text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-blue-900",children:[e.jsx("strong",{children:"Auto-Expiration:"})," If the facility doesn't respond within 72 hours, your application will expire and dates will be unblocked."]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"ri-file-text-line text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-blue-900",children:[e.jsx("strong",{children:"Profile Sharing:"})," Your complete verified profile will be shared with the facility upon submission."]})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex gap-3",children:[e.jsx("button",{onClick:()=>{r(!1),i(null),m("")},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors whitespace-nowrap",children:"Cancel"}),e.jsx("button",{onClick:I,disabled:!d,className:`flex-1 px-6 py-3 rounded-lg font-medium whitespace-nowrap transition-colors ${d?"bg-teal-600 text-white hover:bg-teal-700 cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Submit Application"})]})]})})]})}function Fe({physicianId:s}){const[a,d]=o.useState(new Date),[g,N]=o.useState([]),[D,h]=o.useState(!0),[w,A]=o.useState(null),[T,l]=o.useState(!1),[i,n]=o.useState(!1),[r,b]=o.useState(null),[m,v]=o.useState({startDate:"",endDate:"",blockType:"personal_block",visibility:"private",notes:""}),[y,c]=o.useState(!1);o.useEffect(()=>{S()},[s]);const S=async()=>{h(!0);try{const{data:p}=await L.auth.getUser();if(!p.user)return;const{data:C}=await L.from("physician_profiles").select("id").eq("user_id",p.user.id).maybeSingle();if(!C){h(!1);return}const{data:M,error:_}=await L.from("physician_calendar").select("*").eq("physician_id",C.id).order("start_date",{ascending:!0});if(_){console.error("Error fetching calendar:",_),h(!1);return}const R=(M||[]).map(f=>({id:f.id,startDate:new Date(f.start_date),endDate:new Date(f.end_date),blockType:f.block_type,visibility:f.visibility,assignmentId:f.assignment_id,facilityName:f.facility_name,assignmentTitle:f.assignment_title,notes:f.notes,isBufferDay:f.is_buffer_day}));N(R)}catch(p){console.error("Error:",p)}finally{h(!1)}},k=()=>{d(new Date(a.getFullYear(),a.getMonth()-1,1))},F=()=>{d(new Date(a.getFullYear(),a.getMonth()+1,1))},$=()=>{d(new Date)},I=p=>g.filter(C=>{const M=new Date(C.startDate),_=new Date(C.endDate);M.setHours(0,0,0,0),_.setHours(23,59,59,999);const R=new Date(p);return R.setHours(12,0,0,0),R>=M&&R<=_}),t=o.useMemo(()=>{const p=a.getFullYear(),C=a.getMonth(),M=new Date(p,C,1),_=new Date(p,C+1,0),R=M.getDay(),f=_.getDate(),P=[],G=new Date(p,C,0).getDate();for(let Y=R-1;Y>=0;Y--){const V=new Date(p,C-1,G-Y);P.push({date:V,isCurrentMonth:!1,events:I(V)})}for(let Y=1;Y<=f;Y++){const V=new Date(p,C,Y);P.push({date:V,isCurrentMonth:!0,events:I(V)})}const K=42-P.length;for(let Y=1;Y<=K;Y++){const V=new Date(p,C+1,Y);P.push({date:V,isCurrentMonth:!1,events:I(V)})}return P},[a,g]),j=p=>p.blockType==="assignment"?"bg-teal-500 text-white":p.blockType==="travel_buffer"?"bg-amber-400 text-amber-900":p.blockType==="personal_block"?"bg-red-400 text-white":p.blockType==="available"?p.visibility==="public"?"bg-green-500 text-white":"bg-green-200 text-green-800":"bg-gray-300 text-gray-800",u=p=>{if(p.length===0)return"";const C=p.some(P=>P.blockType==="assignment"),M=p.some(P=>P.blockType==="personal_block"),_=p.some(P=>P.blockType==="travel_buffer"),R=p.some(P=>P.blockType==="available"&&P.visibility==="public"),f=p.some(P=>P.blockType==="available"&&P.visibility==="private");return C?"bg-teal-100 border-l-4 border-teal-500":M?"bg-red-100 border-l-4 border-red-500":_?"bg-amber-100 border-l-4 border-amber-500":R?"bg-green-100 border-l-4 border-green-500":f?"bg-green-50 border-l-4 border-green-300":""},x=(p,C)=>{if(A(p),C.length>0)b(C[0]),n(!0);else{const M=p.toISOString().split("T")[0];v({startDate:M,endDate:M,blockType:"personal_block",visibility:"private",notes:""}),l(!0)}},B=async()=>{c(!0);try{const{data:p}=await L.auth.getUser();if(!p.user)return;const{data:C}=await L.from("physician_profiles").select("id").eq("user_id",p.user.id).maybeSingle();if(!C)return;const{error:M}=await L.from("physician_calendar").insert({physician_id:C.id,start_date:m.startDate,end_date:m.endDate,block_type:m.blockType,visibility:m.visibility,notes:m.notes});if(M){console.error("Error saving block:",M);return}await S(),l(!1),v({startDate:"",endDate:"",blockType:"personal_block",visibility:"private",notes:""})}catch(p){console.error("Error:",p)}finally{c(!1)}},E=async p=>{try{const{error:C}=await L.from("physician_calendar").delete().eq("id",p);if(C){console.error("Error deleting block:",C);return}await S(),n(!1),b(null)}catch(C){console.error("Error:",C)}},U=async(p,C)=>{try{const M=C==="private"?"public":"private",{error:_}=await L.from("physician_calendar").update({visibility:M}).eq("id",p);if(_){console.error("Error updating visibility:",_);return}await S(),r&&b({...r,visibility:M})}catch(M){console.error("Error:",M)}},z=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Q=p=>{const C=new Date;return p.getDate()===C.getDate()&&p.getMonth()===C.getMonth()&&p.getFullYear()===C.getFullYear()};return D?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading calendar..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"My Calendar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your assignments and availability"})]}),e.jsxs("button",{onClick:()=>{const C=new Date().toISOString().split("T")[0];v({startDate:C,endDate:C,blockType:"personal_block",visibility:"private",notes:""}),l(!0)},className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center gap-2 whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-add-line"}),"Block Dates"]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Calendar Color Legend:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-teal-100 border-l-4 border-teal-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Confirmed Assignment"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Booked shifts"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-red-100 border-l-4 border-red-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Personal Block"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Unavailable dates"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-amber-100 border-l-4 border-amber-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Travel Buffer"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-added between assignments"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-100 border-l-4 border-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Available (Public)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Visible to facilities"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-50 border-l-4 border-green-300"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Available (Private)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Only visible to you"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-teal-50 ring-2 ring-inset ring-teal-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Today"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Current date"})]})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:k,className:"w-10 h-10 flex items-center justify-center hover:bg-gray-200 rounded-lg transition-colors cursor-pointer",children:e.jsx("i",{className:"ri-arrow-left-s-line text-xl text-gray-600"})}),e.jsx("button",{onClick:F,className:"w-10 h-10 flex items-center justify-center hover:bg-gray-200 rounded-lg transition-colors cursor-pointer",children:e.jsx("i",{className:"ri-arrow-right-s-line text-xl text-gray-600"})})]}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[z[a.getMonth()]," ",a.getFullYear()]}),e.jsx("button",{onClick:$,className:"px-4 py-2 text-sm font-medium text-teal-600 hover:bg-teal-50 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:"Today"})]}),e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:O.map(p=>e.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-600 bg-gray-50",children:p},p))}),e.jsx("div",{className:"grid grid-cols-7",children:t.map((p,C)=>{const M=u(p.events);return e.jsxs("div",{onClick:()=>x(p.date,p.events),className:`min-h-[100px] p-2 border-b border-r border-gray-100 cursor-pointer transition-colors hover:bg-opacity-80 ${p.isCurrentMonth?"":"bg-gray-50 opacity-60"} ${Q(p.date)&&!M?"bg-teal-50 ring-2 ring-inset ring-teal-400":""} ${M}`,children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${p.isCurrentMonth?Q(p.date)?"text-teal-700 font-bold":"text-gray-900":"text-gray-400"}`,children:p.date.getDate()}),e.jsxs("div",{className:"space-y-1",children:[p.events.slice(0,2).map((_,R)=>e.jsx("div",{className:`text-xs px-2 py-1 rounded truncate ${j(_)}`,title:_.assignmentTitle||_.notes||_.blockType,children:_.blockType==="assignment"&&_.assignmentTitle?_.assignmentTitle:_.blockType==="travel_buffer"?"Travel Buffer":_.blockType==="personal_block"?"Blocked":_.blockType==="available"?`Available ${_.visibility==="public"?"(Public)":""}`:_.blockType},R)),p.events.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 px-2",children:["+",p.events.length-2," more"]})]})]},C)})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"ri-notification-3-line text-teal-600"}),"Automatic Reminders"]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-information-line text-xl text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium mb-2",children:"Automatic reminders are sent to both you and the facility:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-500"}),"30 days before assignment start"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-500"}),"15 days before assignment start"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-500"}),"3 days before assignment start"]})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-3",children:"Reminders are sent via email and dashboard notifications. All reminders are logged for compliance."})]})]})})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Block Dates"}),e.jsx("button",{onClick:()=>l(!1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-lg transition-colors cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xl text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:m.startDate,onChange:p=>v({...m,startDate:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:m.endDate,onChange:p=>v({...m,endDate:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Type"}),e.jsxs("select",{value:m.blockType,onChange:p=>v({...m,blockType:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[e.jsx("option",{value:"personal_block",children:"Personal Block (Unavailable)"}),e.jsx("option",{value:"available",children:"Available for Work"})]})]}),m.blockType==="available"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Visibility"}),e.jsxs("select",{value:m.visibility,onChange:p=>v({...m,visibility:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[e.jsx("option",{value:"private",children:"Private (Only visible to you)"}),e.jsx("option",{value:"public",children:"Public (Visible to facilities)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Public availability will be shown to facilities looking for physicians."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:m.notes,onChange:p=>v({...m,notes:p.target.value}),rows:3,maxLength:500,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none",placeholder:"Add any notes about this block..."})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer whitespace-nowrap",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:y||!m.startDate||!m.endDate,className:"flex-1 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer whitespace-nowrap",children:y?"Saving...":"Save Block"})]})]})}),i&&r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r.blockType==="assignment"?"Assignment Details":r.blockType==="travel_buffer"?"Travel Buffer":r.blockType==="personal_block"?"Personal Block":"Available Dates"}),e.jsx("button",{onClick:()=>{n(!1),b(null)},className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-lg transition-colors cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xl text-gray-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[r.assignmentTitle&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Assignment"}),e.jsx("p",{className:"font-medium text-gray-900",children:r.assignmentTitle})]}),r.facilityName&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Facility"}),e.jsx("p",{className:"font-medium text-gray-900",children:r.facilityName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Start Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:r.startDate.toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"End Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:r.endDate.toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Type"}),e.jsx("p",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${j(r)}`,children:r.blockType==="assignment"?"Confirmed Assignment":r.blockType==="travel_buffer"?"Travel Buffer Day":r.blockType==="personal_block"?"Personal Block":"Available for Work"})]}),r.blockType==="available"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Visibility"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.visibility==="public"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.visibility==="public"?"Public":"Private"}),e.jsx("button",{onClick:()=>U(r.id,r.visibility),className:"text-sm text-teal-600 hover:text-teal-700 cursor-pointer",children:r.visibility==="public"?"Make Private":"Make Public"})]})]}),r.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-gray-900",children:r.notes})]}),r.isBufferDay&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"This is an automatic travel buffer day to allow time between assignments."]})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{n(!1),b(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer whitespace-nowrap",children:"Close"}),(r.blockType==="personal_block"||r.blockType==="available")&&e.jsx("button",{onClick:()=>E(r.id),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors cursor-pointer whitespace-nowrap",children:"Delete Block"})]})]})})]})}function Ee({onFileDispute:s}){const[a,d]=o.useState("browse");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto",children:e.jsxs("div",{className:"flex border-b border-gray-200 min-w-max",children:[e.jsxs("button",{onClick:()=>d("browse"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="browse"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-search-line mr-2"}),"Browse Jobs"]}),e.jsxs("button",{onClick:()=>d("calendar"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="calendar"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-calendar-2-line mr-2"}),"My Calendar"]}),e.jsxs("button",{onClick:()=>d("pending"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="pending"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-time-line mr-2"}),"Pending Applications"]}),e.jsxs("button",{onClick:()=>d("invited"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="invited"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-mail-check-line mr-2"}),"Invited / Accepted"]}),e.jsxs("button",{onClick:()=>d("upcoming"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="upcoming"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-calendar-check-line mr-2"}),"Upcoming Confirmed"]}),e.jsxs("button",{onClick:()=>d("completed"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="completed"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-checkbox-circle-line mr-2"}),"Completed"]}),e.jsxs("button",{onClick:()=>d("requests"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="requests"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-message-3-line mr-2"}),"Facility Requests"]}),e.jsxs("button",{onClick:()=>d("insurance"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="insurance"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-shield-check-line mr-2"}),"Insurance"]}),e.jsxs("button",{onClick:()=>d("services"),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap transition-colors ${a==="services"?"text-teal-600 border-b-2 border-teal-600 bg-teal-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("i",{className:"ri-customer-service-2-line mr-2"}),"Third-Party Services"]})]})}),e.jsxs("div",{children:[a==="browse"&&e.jsx(Me,{physicianId:"phy-001"}),a==="calendar"&&e.jsx(Fe,{physicianId:"phy-001"}),a==="pending"&&e.jsx(ge,{}),a==="invited"&&e.jsx(fe,{}),a==="upcoming"&&e.jsx(ye,{}),a==="completed"&&e.jsx(Ne,{}),a==="requests"&&e.jsx(we,{}),a==="insurance"&&e.jsx(Se,{}),a==="services"&&e.jsx($e,{})]})]})}const Le=300,Be="USD",J=(s,a)=>Le,Oe=s=>{const a=`DSP-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,d=J(),g={id:a,assignmentId:s.assignmentId,assignmentTitle:s.assignmentTitle,facility:s.facility,physician:s.physician,initiatedBy:s.initiatedBy,initiatorId:s.initiatorId,initiatorName:s.initiatorName,respondentId:s.respondentId,respondentName:s.respondentName,respondentRole:s.respondentRole,type:s.type,status:"open",priority:Ue(s.type),subject:s.subject,description:s.description,evidence:[],messages:[],fee:{id:`FEE-${a}`,disputeId:a,amount:d,currency:Be,paidBy:s.initiatorId,paidByRole:s.initiatedBy,paymentStatus:"pending"},escrowHeld:!0,escrowAmount:s.escrowAmount,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),metadata:{ipAddress:"0.0.0.0",userAgent:navigator.userAgent,deviceType:/Mobile|Android|iPhone/i.test(navigator.userAgent)?"mobile":"desktop"}};return Ye(g),g},Ue=s=>({payment_dispute:"high",contract_violation:"high",quality_complaint:"medium",cancellation_dispute:"medium",no_show:"urgent",credential_misrepresentation:"urgent",facility_breach:"high",other:"low"})[s],Ye=s=>{s.status="escalated",s.escalatedAt=new Date().toISOString(),s.updatedAt=new Date().toISOString(),console.log(`Dispute ${s.id} auto-escalated to admin panel`)},Qe=async(s,a)=>{try{const d=`TXN-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`;return await new Promise(g=>setTimeout(g,1e3)),{success:!0,transactionId:d}}catch{return{success:!1,error:"Payment processing failed"}}},ze=(s,a)=>({allowed:!0,feeAmount:J()}),Ve=s=>{const a={id:`LOG-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,disputeId:s.disputeId,action:s.action,performedBy:s.performedBy,performedByRole:s.performedByRole,details:s.details,timestamp:new Date().toISOString(),ipAddress:"0.0.0.0",userAgent:navigator.userAgent,metadata:s.metadata};console.log("Dispute audit log:",a)},H=[{value:"payment_dispute",label:"Payment Dispute",description:"Issues with payment amount, timing, or processing"},{value:"contract_violation",label:"Contract Violation",description:"Breach of contract terms or conditions"},{value:"quality_complaint",label:"Quality Complaint",description:"Concerns about service quality or performance"},{value:"cancellation_dispute",label:"Cancellation Dispute",description:"Issues related to assignment cancellation"},{value:"no_show",label:"No-Show",description:"Physician did not appear for scheduled assignment"},{value:"credential_misrepresentation",label:"Credential Misrepresentation",description:"False or misleading credential information"},{value:"facility_breach",label:"Facility Breach",description:"Facility failed to meet contractual obligations"},{value:"other",label:"Other",description:"Other dispute not covered by above categories"}];function He({isOpen:s,onClose:a,assignmentId:d,assignmentTitle:g,facility:N,physician:D,initiatedBy:h,initiatorId:w,initiatorName:A,respondentId:T,respondentName:l,respondentRole:i,escrowAmount:n,onDisputeCreated:r}){const[b,m]=o.useState("eligibility"),[v,y]=o.useState("payment_dispute"),[c,S]=o.useState(""),[k,F]=o.useState(""),[$,I]=o.useState([]),[t,j]=o.useState(""),[u,x]=o.useState(!1),[B,E]=o.useState(""),[U,z]=o.useState(300),[O,Q]=o.useState(null),p=()=>{const f=ze();Q(f),f.allowed&&f.feeAmount&&(z(f.feeAmount),m("details"))},C=f=>{f.target.files&&I(Array.from(f.target.files))},M=()=>{if(!c.trim()||!k.trim()){E("Please provide both subject and description");return}if(k.length<50){E("Description must be at least 50 characters");return}E(""),m("payment")},_=async()=>{if(!t){E("Please provide payment method");return}x(!0),E("");try{const f=await Qe("temp-dispute-id",t);if(!f.success){E(f.error||"Payment processing failed"),x(!1);return}const P=Oe({assignmentId:d,assignmentTitle:g,facility:N,physician:D,initiatedBy:h,initiatorId:w,initiatorName:A,respondentId:T,respondentName:l,respondentRole:i,type:v,subject:c,description:k,escrowAmount:n});P.fee.transactionId=f.transactionId,P.fee.paymentStatus="paid",P.fee.paidAt=new Date().toISOString(),Ve({disputeId:P.id,action:"dispute_created",performedBy:w,performedByRole:h,details:`Dispute created: ${c}`,metadata:{disputeType:v,feeAmount:U,transactionId:f.transactionId}}),x(!1),m("confirmation"),r&&r(P.id),setTimeout(()=>{R()},3e3)}catch{E("Failed to create dispute. Please try again."),x(!1)}},R=()=>{m("eligibility"),y("payment_dispute"),S(""),F(""),I([]),j(""),E(""),Q(null),a()};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"File a Dispute"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:g})]}),e.jsx("button",{onClick:R,className:"w-8 h-8 flex items-center justify-center text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${b==="eligibility"?"bg-teal-500 text-white":"bg-teal-100 text-teal-600"}`,children:e.jsx("i",{className:"ri-shield-check-line"})}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Eligibility"})]}),e.jsx("div",{className:"flex-1 h-0.5 bg-slate-200 mx-2"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${b==="details"||b==="payment"||b==="confirmation"?"bg-teal-500 text-white":"bg-slate-200 text-slate-400"}`,children:e.jsx("i",{className:"ri-file-text-line"})}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Details"})]}),e.jsx("div",{className:"flex-1 h-0.5 bg-slate-200 mx-2"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${b==="payment"||b==="confirmation"?"bg-teal-500 text-white":"bg-slate-200 text-slate-400"}`,children:e.jsx("i",{className:"ri-bank-card-line"})}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Payment"})]})]}),b==="eligibility"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("i",{className:"ri-alert-line text-xl text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-amber-900 mb-2",children:"Important Information"}),e.jsxs("ul",{className:"text-sm text-amber-800 space-y-1",children:[e.jsxs("li",{children:["• A mandatory dispute fee of $",U," will be charged"]}),e.jsx("li",{children:"• The fee is refunded if the dispute is resolved in your favor"}),e.jsx("li",{children:"• Frivolous disputes may result in penalties and restrictions"}),e.jsx("li",{children:"• All disputes are automatically escalated to admin review"}),e.jsx("li",{children:"• Escrow funds will be held until resolution"})]})]})]})}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Assignment Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Facility:"}),e.jsx("p",{className:"font-medium text-slate-900",children:N.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Physician:"}),e.jsx("p",{className:"font-medium text-slate-900",children:D.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Specialty:"}),e.jsx("p",{className:"font-medium text-slate-900",children:D.specialty})]}),n&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Escrow Amount:"}),e.jsxs("p",{className:"font-medium text-slate-900",children:["$",n.toLocaleString()]})]})]})]}),O&&!O.allowed&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("i",{className:"ri-error-warning-line text-xl text-red-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Cannot File Dispute"}),e.jsx("p",{className:"text-sm text-red-800",children:O.reason})]})]})}),O&&O.allowed&&O.reason&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("i",{className:"ri-information-line text-xl text-blue-600 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-blue-800",children:O.reason})})]})}),e.jsx("button",{onClick:p,className:"w-full bg-teal-500 text-white py-3 rounded-lg font-medium hover:bg-teal-600 transition-colors whitespace-nowrap",children:"Continue to Dispute Details"})]}),b==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Dispute Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:v,onChange:f=>y(f.target.value),className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:H.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:H.find(f=>f.value===v)?.description})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c,onChange:f=>S(f.target.value),placeholder:"Brief summary of the dispute",className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",maxLength:200}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[c.length,"/200 characters"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Detailed Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:k,onChange:f=>F(f.target.value),placeholder:"Provide a detailed explanation of the dispute, including dates, specific incidents, and any relevant context. Minimum 50 characters.",rows:6,className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none",maxLength:2e3}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[k.length,"/2000 characters ",k.length<50&&"(minimum 50 required)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Supporting Evidence (Optional)"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",multiple:!0,onChange:C,className:"hidden",id:"evidence-upload",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.zip"}),e.jsxs("label",{htmlFor:"evidence-upload",className:"cursor-pointer",children:[e.jsx("i",{className:"ri-upload-cloud-line text-4xl text-slate-400 mb-2"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Click to upload files"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PDF, DOC, JPG, PNG, ZIP (max 10MB each)"})]})]}),$.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:$.map((f,P)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700 bg-slate-50 px-3 py-2 rounded",children:[e.jsx("i",{className:"ri-file-line"}),e.jsx("span",{className:"flex-1",children:f.name}),e.jsxs("span",{className:"text-slate-500",children:[(f.size/1024).toFixed(1)," KB"]})]},P))})]}),B&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:B}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>m("eligibility"),className:"flex-1 border border-slate-300 text-slate-700 py-3 rounded-lg font-medium hover:bg-slate-50 transition-colors whitespace-nowrap",children:"Back"}),e.jsx("button",{onClick:M,className:"flex-1 bg-teal-500 text-white py-3 rounded-lg font-medium hover:bg-teal-600 transition-colors whitespace-nowrap",children:"Continue to Payment"})]})]}),b==="payment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Dispute Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Type:"}),e.jsx("span",{className:"font-medium text-slate-900",children:H.find(f=>f.value===v)?.label})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Subject:"}),e.jsx("span",{className:"font-medium text-slate-900",children:c})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Evidence Files:"}),e.jsxs("span",{className:"font-medium text-slate-900",children:[$.length," file(s)"]})]})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:"ri-information-line text-xl text-amber-600 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsxs("p",{className:"font-semibold mb-1",children:["Dispute Fee: $",U]}),e.jsx("p",{children:"This fee will be refunded if the dispute is resolved in your favor. The fee helps prevent frivolous disputes and covers administrative costs."})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t,onChange:f=>j(f.target.value),placeholder:"Enter payment method ID (e.g., card_1234...)",className:"w-full px-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"In production, this would integrate with Stripe/PayPal payment form"})]}),B&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:B}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>m("details"),disabled:u,className:"flex-1 border border-slate-300 text-slate-700 py-3 rounded-lg font-medium hover:bg-slate-50 transition-colors disabled:opacity-50 whitespace-nowrap",children:"Back"}),e.jsx("button",{onClick:_,disabled:u,className:"flex-1 bg-teal-500 text-white py-3 rounded-lg font-medium hover:bg-teal-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2 whitespace-nowrap",children:u?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Processing..."]}):`Pay $${U} & Submit Dispute`})]})]}),b==="confirmation"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-check-line text-3xl text-green-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Dispute Filed Successfully"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Your dispute has been submitted and automatically escalated to our admin team for review."}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 text-left space-y-2 text-sm mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Dispute Fee:"}),e.jsxs("span",{className:"font-medium text-slate-900",children:["$",U," (Paid)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Escrow Status:"}),e.jsx("span",{className:"font-medium text-amber-600",children:"Held"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Next Steps:"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Admin Review"})]})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"You will receive email and dashboard notifications as your dispute progresses."})]})]})]})}):null}const qe=(s,a,d,g,N,D,h,w,A,T,l,i,n,r)=>{const b=g==="physician"?"physician_to_facility":"facility_to_physician";return{id:`rev-${Date.now()}`,assignmentId:s,reviewType:b,reviewerId:a,reviewerName:A==="anonymous"?"Anonymous":d,reviewerRole:g,revieweeId:N,revieweeName:D,revieweeRole:h,rating:w,visibility:A,title:T,comment:l,pros:i,cons:n,wouldWorkAgain:r,status:"submitted",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),helpfulCount:0,reportCount:0}},We=({isOpen:s,onClose:a,assignmentId:d,reviewerId:g,reviewerName:N,reviewerRole:D,revieweeId:h,revieweeName:w,revieweeRole:A,onSubmit:T})=>{const[l,i]=o.useState(1),[n,r]=o.useState(0),[b,m]=o.useState(0),[v,y]=o.useState("public"),[c,S]=o.useState(""),[k,F]=o.useState(""),[$,I]=o.useState([""]),[t,j]=o.useState([""]),[u,x]=o.useState(null),[B,E]=o.useState(!1);if(!s)return null;const U=()=>{I([...$,""])},z=R=>{I($.filter((f,P)=>P!==R))},O=(R,f)=>{const P=[...$];P[R]=f,I(P)},Q=()=>{j([...t,""])},p=R=>{j(t.filter((f,P)=>P!==R))},C=(R,f)=>{const P=[...t];P[R]=f,j(P)},M=async()=>{if(n===0||!c||!k||u===null){alert("Please complete all required fields");return}E(!0);try{const R=qe(d,g,N,D,h,w,A,n,v,c,k,$.filter(f=>f.trim()!==""),t.filter(f=>f.trim()!==""),u);T(R),i(3),setTimeout(()=>{a(),_()},2e3)}catch{alert("Failed to submit review. Please try again."),E(!1)}},_=()=>{i(1),r(0),m(0),y("public"),S(""),F(""),I([""]),j([""]),x(null),E(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Leave a Review"}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["Share your experience with ",w]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),l<3&&e.jsx("div",{className:"px-6 py-4 bg-slate-50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${l>=1?"bg-teal-500 text-white":"bg-slate-200 text-slate-500"}`,children:"1"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-slate-700",children:"Rating"})]}),e.jsx("div",{className:"flex-1 h-0.5 bg-slate-200 mx-4",children:e.jsx("div",{className:`h-full bg-teal-500 transition-all ${l>=2?"w-full":"w-0"}`})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full ${l>=2?"bg-teal-500 text-white":"bg-slate-200 text-slate-500"}`,children:"2"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-slate-700",children:"Details"})]})]})}),l===1&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"How would you rate your experience?"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Your honest feedback helps others make informed decisions"})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mb-8",children:[1,2,3,4,5].map(R=>e.jsx("button",{onClick:()=>r(R),onMouseEnter:()=>m(R),onMouseLeave:()=>m(0),className:"w-12 h-12 flex items-center justify-center transition-transform hover:scale-110 whitespace-nowrap",children:e.jsx("i",{className:`text-4xl ${R<=(b||n)?"ri-star-fill text-amber-400":"ri-star-line text-slate-300"}`})},R))}),n>0&&e.jsx("div",{className:"text-center mb-8",children:e.jsxs("p",{className:"text-lg font-medium text-slate-900",children:[n===5&&"Excellent!",n===4&&"Very Good",n===3&&"Good",n===2&&"Fair",n===1&&"Poor"]})}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-3 block",children:"Review Visibility"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>y("public"),className:`flex-1 p-3 rounded-lg border-2 transition-all whitespace-nowrap ${v==="public"?"border-teal-500 bg-teal-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-user-line text-lg"}),e.jsx("span",{className:"font-medium",children:"Public"})]}),e.jsx("p",{className:"text-xs text-slate-600 mt-1",children:"Show my name"})]}),e.jsxs("button",{onClick:()=>y("anonymous"),className:`flex-1 p-3 rounded-lg border-2 transition-all whitespace-nowrap ${v==="anonymous"?"border-teal-500 bg-teal-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-user-unfollow-line text-lg"}),e.jsx("span",{className:"font-medium",children:"Anonymous"})]}),e.jsx("p",{className:"text-xs text-slate-600 mt-1",children:"Hide my identity"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-700 mb-3 block",children:["Would you work with ",w," again? *"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>x(!0),className:`flex-1 p-3 rounded-lg border-2 transition-all whitespace-nowrap ${u===!0?"border-green-500 bg-green-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx("i",{className:"ri-thumb-up-line text-xl text-green-600"}),e.jsx("p",{className:"font-medium mt-1",children:"Yes"})]}),e.jsxs("button",{onClick:()=>x(!1),className:`flex-1 p-3 rounded-lg border-2 transition-all whitespace-nowrap ${u===!1?"border-red-500 bg-red-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx("i",{className:"ri-thumb-down-line text-xl text-red-600"}),e.jsx("p",{className:"font-medium mt-1",children:"No"})]})]})]}),e.jsx("button",{onClick:()=>i(2),disabled:n===0||u===null,className:"w-full py-3 bg-teal-500 text-white rounded-lg font-medium hover:bg-teal-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:"Continue"})]}),l===2&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"Review Title *"}),e.jsx("input",{type:"text",value:c,onChange:R=>S(R.target.value),placeholder:"Summarize your experience",maxLength:200,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[c.length,"/200 characters"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"Detailed Review *"}),e.jsx("textarea",{value:k,onChange:R=>F(R.target.value),placeholder:"Share your experience in detail...",rows:5,maxLength:2e3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[k.length,"/2000 characters"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"What went well? (Optional)"}),$.map((R,f)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:R,onChange:P=>O(f,P.target.value),placeholder:"e.g., Great communication",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"}),$.length>1&&e.jsx("button",{onClick:()=>z(f),className:"w-10 h-10 flex items-center justify-center text-red-500 hover:bg-red-50 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]},f)),$.length<5&&e.jsx("button",{onClick:U,className:"text-sm text-teal-600 hover:text-teal-700 font-medium whitespace-nowrap",children:"+ Add another pro"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"What could be improved? (Optional)"}),t.map((R,f)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:R,onChange:P=>C(f,P.target.value),placeholder:"e.g., Better scheduling",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"}),t.length>1&&e.jsx("button",{onClick:()=>p(f),className:"w-10 h-10 flex items-center justify-center text-red-500 hover:bg-red-50 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]},f)),t.length<5&&e.jsx("button",{onClick:Q,className:"text-sm text-teal-600 hover:text-teal-700 font-medium whitespace-nowrap",children:"+ Add another con"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>i(1),className:"flex-1 py-3 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition-colors whitespace-nowrap",children:"Back"}),e.jsx("button",{onClick:M,disabled:!c||!k||B,className:"flex-1 py-3 bg-teal-500 text-white rounded-lg font-medium hover:bg-teal-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:B?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Submitting..."]}):"Submit Review"})]})]}),l===3&&e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 flex items-center justify-center bg-green-100 rounded-full mx-auto mb-4",children:e.jsx("i",{className:"ri-check-line text-3xl text-green-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Review Submitted!"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Thank you for sharing your feedback. Your review helps build trust in our community."}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-slate-600",children:["Your review will be visible on ",w,"'s profile shortly."]})})]})]})})},Je=({reviewRequests:s,currentUserId:a,currentUserRole:d,onReviewSubmitted:g})=>{const[N,D]=o.useState(!1),[h,w]=o.useState(null),[A,T]=o.useState([]),l=s.filter(m=>A.includes(m.id)?!1:d==="physician"?m.physicianId===a&&!m.physicianReviewSubmitted:m.facilityId===a&&!m.facilityReviewSubmitted),i=m=>{w(m),D(!0)},n=m=>{T([...A,m])},r=()=>{h&&(g(h.id),D(!1),w(null),n(h.id))},b=m=>{const v=new Date,c=new Date(m).getTime()-v.getTime();return Math.ceil(c/(1e3*60*60*24))};return l.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-teal-600 text-white rounded-lg shadow-lg mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-white/20 rounded-full flex-shrink-0",children:e.jsx("i",{className:"ri-star-line text-2xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:l.length===1?"You have a pending review request":`You have ${l.length} pending review requests`}),e.jsx("p",{className:"text-teal-50 mb-4",children:"Share your experience to help build trust in our community"}),e.jsx("div",{className:"space-y-3",children:l.map(m=>{const v=b(m.expiresAt),y=v<=3,c=d==="physician"?m.facilityName:m.physicianName;return e.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold mb-1",children:c}),e.jsxs("p",{className:"text-sm text-teal-50",children:["Assignment ID: ",m.assignmentId]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("i",{className:"ri-time-line text-sm"}),e.jsx("span",{className:"text-sm",children:y?e.jsxs("span",{className:"font-semibold",children:[v," ",v===1?"day":"days"," remaining"]}):`${v} days remaining`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i(m),className:"px-4 py-2 bg-white text-teal-600 rounded-lg font-medium hover:bg-teal-50 transition-colors whitespace-nowrap",children:"Leave Review"}),e.jsx("button",{onClick:()=>n(m.id),className:"w-8 h-8 flex items-center justify-center text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})]})},m.id)})})]})]})})}),h&&e.jsx(We,{isOpen:N,onClose:()=>{D(!1),w(null)},assignmentId:h.assignmentId,reviewerId:a,reviewerName:d==="physician"?h.physicianName:h.facilityName,reviewerRole:d,revieweeId:d==="physician"?h.facilityId:h.physicianId,revieweeName:d==="physician"?h.facilityName:h.physicianName,revieweeRole:d==="physician"?"facility":"physician",onSubmit:r})]})},ss=()=>{const s=X(),[a,d]=o.useState(!1),[g,N]=o.useState(!1),[D,h]=o.useState(!1),[w,A]=o.useState(null),[T,l]=o.useState("Physician"),[i,n]=o.useState(""),[r,b]=o.useState([]),{profile:m,completionPercentage:v,isProfileComplete:y,loading:c}=W();o.useEffect(()=>{(async()=>{try{const{data:{user:t}}=await L.auth.getUser();if(t){if(n(t.id),m?.personalIdentifiers){const u=m.personalIdentifiers.legalFirstName||m.personalIdentifiers.firstName||m.personalIdentifiers.first_name;if(u){l(u);return}}const j=t.user_metadata?.full_name||t.user_metadata?.name;if(j){const u=j.split(" ")[0];l(u)}}}catch(t){console.error("Error getting user info:",t)}})()},[m]),o.useEffect(()=>{(async()=>{try{const{data:t}=await L.auth.getUser();if(!t.user)return;b([])}catch(t){console.error("Error fetching review requests:",t)}})()},[]);const S=async I=>{console.log("Review submitted for request:",I),b(t=>t.filter(j=>j.id!==I))},k=I=>{A(I),h(!0)},F=()=>{s("/profile-completion")},$=async()=>{await L.auth.signOut(),s("/login")};return c?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-teal-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-slate-600",children:"Loading your dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("nav",{className:"bg-white border-b border-slate-200 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("button",{onClick:()=>s("/"),className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-teal-500 rounded-lg",children:e.jsx("i",{className:"ri-stethoscope-line text-lg text-white"})}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:"LOCUM BNB"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>d(!a),className:"w-10 h-10 flex items-center justify-center text-slate-600 hover:bg-slate-100 rounded-lg transition-colors whitespace-nowrap relative",children:[e.jsx("i",{className:"ri-notification-3-line text-xl"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("button",{onClick:()=>N(!0),className:"w-10 h-10 flex items-center justify-center text-slate-600 hover:bg-slate-100 rounded-lg transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-settings-3-line text-xl"})}),e.jsx(ce,{userName:T,userRole:"physician",onLogout:$})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(pe,{isComplete:y,completionPercentage:v,onCompleteProfile:F}),e.jsx(Je,{reviewRequests:r,currentUserId:i,currentUserRole:"physician",onReviewSubmitted:S}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:["Welcome back, ",T]}),e.jsx("p",{className:"text-slate-600",children:"Manage your assignments and opportunities"})]}),e.jsx(Ee,{onFileDispute:k})]}),e.jsx(Z,{isOpen:a,onClose:()=>d(!1)}),e.jsx(de,{isOpen:g,onClose:()=>N(!1),userRole:"physician"}),w&&e.jsx(He,{isOpen:D,onClose:()=>{h(!1),A(null)},assignmentId:w,initiatorId:i,initiatorName:T,initiatorRole:"physician",respondentId:"fac-001",respondentName:"Memorial Hospital",respondentRole:"facility"})]})};export{ss as default};
//# sourceMappingURL=page-2QRTjG4p.js.map
