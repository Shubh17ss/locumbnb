const u={super:{canViewUsers:!0,canModifyUsers:!0,canSuspendUsers:!0,canVerifyUsers:!0,canViewFinancials:!0,canModifyPayments:!0,canHoldPayments:!0,canReleasePayments:!0,canViewDisputes:!0,canResolveDisputes:!0,canEscalateDisputes:!0,canViewContracts:!0,canEnforcePolicy:!0,canApplyPenalties:!0,canManageVendors:!0,canViewVendorData:!0,canModerateContent:!0,canRemoveContent:!0,canViewAnalytics:!0,canExportData:!0,canManageAdmins:!0,canViewAuditLogs:!0,hasFullOverride:!0},operations_manager:{canViewUsers:!0,canModifyUsers:!0,canSuspendUsers:!1,canVerifyUsers:!0,canViewFinancials:!0,canModifyPayments:!1,canHoldPayments:!1,canReleasePayments:!1,canViewDisputes:!0,canResolveDisputes:!1,canEscalateDisputes:!0,canViewContracts:!0,canEnforcePolicy:!1,canApplyPenalties:!1,canManageVendors:!0,canViewVendorData:!0,canModerateContent:!0,canRemoveContent:!1,canViewAnalytics:!0,canExportData:!0,canManageAdmins:!1,canViewAuditLogs:!0,hasFullOverride:!1},compliance_manager:{canViewUsers:!0,canModifyUsers:!1,canSuspendUsers:!0,canVerifyUsers:!0,canViewFinancials:!1,canModifyPayments:!1,canHoldPayments:!1,canReleasePayments:!1,canViewDisputes:!0,canResolveDisputes:!0,canEscalateDisputes:!0,canViewContracts:!0,canEnforcePolicy:!0,canApplyPenalties:!0,canManageVendors:!1,canViewVendorData:!1,canModerateContent:!0,canRemoveContent:!0,canViewAnalytics:!0,canExportData:!0,canManageAdmins:!1,canViewAuditLogs:!0,hasFullOverride:!1},finance_manager:{canViewUsers:!0,canModifyUsers:!1,canSuspendUsers:!1,canVerifyUsers:!1,canViewFinancials:!0,canModifyPayments:!0,canHoldPayments:!0,canReleasePayments:!0,canViewDisputes:!0,canResolveDisputes:!0,canEscalateDisputes:!1,canViewContracts:!0,canEnforcePolicy:!1,canApplyPenalties:!1,canManageVendors:!1,canViewVendorData:!1,canModerateContent:!1,canRemoveContent:!1,canViewAnalytics:!0,canExportData:!0,canManageAdmins:!1,canViewAuditLogs:!0,hasFullOverride:!1},support_agent:{canViewUsers:!0,canModifyUsers:!1,canSuspendUsers:!1,canVerifyUsers:!1,canViewFinancials:!1,canModifyPayments:!1,canHoldPayments:!1,canReleasePayments:!1,canViewDisputes:!0,canResolveDisputes:!1,canEscalateDisputes:!1,canViewContracts:!0,canEnforcePolicy:!1,canApplyPenalties:!1,canManageVendors:!1,canViewVendorData:!1,canModerateContent:!1,canRemoveContent:!1,canViewAnalytics:!1,canExportData:!1,canManageAdmins:!1,canViewAuditLogs:!1,hasFullOverride:!1}},f=i=>u[i],p={super:"super",operations_manager:"Operations Manager",compliance_manager:"Compliance Manager",finance_manager:"Finance Manager",support_agent:"Support Agent"},m={super:"Full platform access with override authority (limited to 3 users)",operations_manager:"Workflow monitoring, assignment oversight, vendor operations",compliance_manager:"Credential verification, contract enforcement, policy violations",finance_manager:"Escrow monitoring, payment flows, fee collection",support_agent:"View-only access, ticket responses (limited permissions)"};class d{logs=[];log(e,n,a,t,s,c,o,l){const r={id:`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),adminId:e,adminEmail:n,adminRole:a,action:t,entityType:s,entityId:c,details:o,ipAddress:this.getClientIP(),deviceInfo:this.getDeviceInfo(),sessionId:l};this.logs.push(r),this.persistLog(r),console.log("[ADMIN AUDIT]",r)}persistLog(e){try{const n=localStorage.getItem("admin_audit_logs"),a=n?JSON.parse(n):[];a.push(e),a.length>1e3&&a.shift(),localStorage.setItem("admin_audit_logs",JSON.stringify(a))}catch(n){console.error("Failed to persist audit log:",n)}}getLogs(e){try{const n=localStorage.getItem("admin_audit_logs");let a=n?JSON.parse(n):[];return e&&(e.adminId&&(a=a.filter(t=>t.adminId===e.adminId)),e.action&&(a=a.filter(t=>t.action===e.action)),e.entityType&&(a=a.filter(t=>t.entityType===e.entityType)),e.startDate&&(a=a.filter(t=>t.timestamp>=e.startDate)),e.endDate&&(a=a.filter(t=>t.timestamp<=e.endDate))),a.sort((t,s)=>new Date(s.timestamp).getTime()-new Date(t.timestamp).getTime())}catch(n){return console.error("Failed to retrieve audit logs:",n),[]}}getClientIP(){return"Client IP (captured server-side)"}getDeviceInfo(){const e=navigator.userAgent,n=this.getBrowserInfo(e),a=this.getOSInfo(e);return`${n} on ${a}`}getBrowserInfo(e){return e.includes("Chrome")?"Chrome":e.includes("Firefox")?"Firefox":e.includes("Safari")?"Safari":e.includes("Edge")?"Edge":"Unknown Browser"}getOSInfo(e){return e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":e.includes("Android")?"Android":e.includes("iOS")?"iOS":"Unknown OS"}exportLogs(e="json"){const n=this.getLogs();if(e==="csv"){const a=["Timestamp","Admin Email","Role","Action","Entity Type","Entity ID","IP Address","Device"],t=n.map(s=>[s.timestamp,s.adminEmail,s.adminRole,s.action,s.entityType,s.entityId,s.ipAddress,s.deviceInfo]);return[a,...t].map(s=>s.join(",")).join(`
`)}return JSON.stringify(n,null,2)}}const g=new d;export{p as R,g as a,m as b,f as g};
//# sourceMappingURL=adminAuditLogger-DDwDAuyc.js.map
